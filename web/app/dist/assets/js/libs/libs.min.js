/*@license
Copyright (c) 2010, Matt Westcott & Ben Firshman
All rights reserved.
 
Redistribution and use in source and binary forms, with or without 
modification, are permitted provided that the following conditions are met:
 
 * Redistributions of source code must retain the above copyright notice, this 
   list of conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation 
   and/or other materials provided with the distribution.
 * The names of its contributors may not be used to endorse or promote products 
   derived from this software without specific prior written permission.
 
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND 
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED 
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE 
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR 
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES 
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; 
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON 
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT 
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS 
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.*/
function MidiFile(e){function t(e){var t=e.read(4),n=e.readInt32();return{id:t,length:n,data:e.read(n)}}var n;function r(e){var t={};t.deltaTime=e.readVarInt();var r=e.readInt8();if(240==(240&r)){if(255==r){t.type="meta";var i=e.readInt8(),a=e.readVarInt();switch(i){case 0:if(t.subtype="sequenceNumber",2!=a)throw"Expected length for sequenceNumber event is 2, got "+a;return t.number=e.readInt16(),t;case 1:return t.subtype="text",t.text=e.read(a),t;case 2:return t.subtype="copyrightNotice",t.text=e.read(a),t;case 3:return t.subtype="trackName",t.text=e.read(a),t;case 4:return t.subtype="instrumentName",t.text=e.read(a),t;case 5:return t.subtype="lyrics",t.text=e.read(a),t;case 6:return t.subtype="marker",t.text=e.read(a),t;case 7:return t.subtype="cuePoint",t.text=e.read(a),t;case 32:if(t.subtype="midiChannelPrefix",1!=a)throw"Expected length for midiChannelPrefix event is 1, got "+a;return t.channel=e.readInt8(),t;case 47:if(t.subtype="endOfTrack",0!=a)throw"Expected length for endOfTrack event is 0, got "+a;return t;case 81:if(t.subtype="setTempo",3!=a)throw"Expected length for setTempo event is 3, got "+a;return t.microsecondsPerBeat=(e.readInt8()<<16)+(e.readInt8()<<8)+e.readInt8(),t;case 84:if(t.subtype="smpteOffset",5!=a)throw"Expected length for smpteOffset event is 5, got "+a;var o=e.readInt8();return t.frameRate={0:24,32:25,64:29,96:30}[96&o],t.hour=31&o,t.min=e.readInt8(),t.sec=e.readInt8(),t.frame=e.readInt8(),t.subframe=e.readInt8(),t;case 88:if(t.subtype="timeSignature",4!=a)throw"Expected length for timeSignature event is 4, got "+a;return t.numerator=e.readInt8(),t.denominator=Math.pow(2,e.readInt8()),t.metronome=e.readInt8(),t.thirtyseconds=e.readInt8(),t;case 89:if(t.subtype="keySignature",2!=a)throw"Expected length for keySignature event is 2, got "+a;return t.key=e.readInt8(!0),t.scale=e.readInt8(),t;case 127:return t.subtype="sequencerSpecific",t.data=e.read(a),t;default:return t.subtype="unknown",t.data=e.read(a),t}return t.data=e.read(a),t}if(240==r){t.type="sysEx";a=e.readVarInt();return t.data=e.read(a),t}if(247==r){t.type="dividedSysEx";a=e.readVarInt();return t.data=e.read(a),t}throw"Unrecognised MIDI event type byte: "+r}var s;0==(128&r)?(s=r,r=n):(s=e.readInt8(),n=r);var u=r>>4;switch(t.channel=15&r,t.type="channel",u){case 8:return t.subtype="noteOff",t.noteNumber=s,t.velocity=e.readInt8(),t;case 9:return t.noteNumber=s,t.velocity=e.readInt8(),0==t.velocity?t.subtype="noteOff":t.subtype="noteOn",t;case 10:return t.subtype="noteAftertouch",t.noteNumber=s,t.amount=e.readInt8(),t;case 11:return t.subtype="controller",t.controllerType=s,t.value=e.readInt8(),t;case 12:return t.subtype="programChange",t.programNumber=s,t;case 13:return t.subtype="channelAftertouch",t.amount=s,t;case 14:return t.subtype="pitchBend",t.value=s+(e.readInt8()<<7),t;default:throw"Unrecognised MIDI event type: "+u}}stream=Stream(e);var i=t(stream);if("MThd"!=i.id||6!=i.length)throw"Bad .mid file - header not found";var a=Stream(i.data),o=a.readInt16(),s=a.readInt16(),u=a.readInt16();if(32768&u)throw"Expressing time division in SMTPE frames is not supported yet";ticksPerBeat=u;for(var l={formatType:o,trackCount:s,ticksPerBeat:ticksPerBeat},c=[],f=0;f<l.trackCount;f++){c[f]=[];var d=t(stream);if("MTrk"!=d.id)throw"Unexpected chunk - expected MTrk, got "+d.id;for(var h=Stream(d.data);!h.eof();){var p=r(h);c[f].push(p)}}return{header:l,tracks:c}}var clone=function(e){if("object"!=typeof e)return e;if(null==e)return e;var t="number"==typeof e.length?[]:{};for(var n in e)t[n]=clone(e[n]);return t};function Replayer(e,t,n,r){for(var i=[],a=r||120,o=!!r,s=e.header.ticksPerBeat,u=0;u<e.tracks.length;u++)i[u]={nextEventIndex:0,ticksToNextEvent:e.tracks[u].length?e.tracks[u][0].deltaTime:null};function l(){for(var t=null,n=null,r=null,a=0;a<i.length;a++)null!=i[a].ticksToNextEvent&&(null==t||i[a].ticksToNextEvent<t)&&(t=i[a].ticksToNextEvent,n=a,r=i[a].nextEventIndex);if(null!=n){var o=e.tracks[n][r];e.tracks[n][r+1]?i[n].ticksToNextEvent+=e.tracks[n][r+1].deltaTime:i[n].ticksToNextEvent=null,i[n].nextEventIndex+=1;for(a=0;a<i.length;a++)null!=i[a].ticksToNextEvent&&(i[a].ticksToNextEvent-=t);return{ticksToEvent:t,event:o,track:n}}return null}var c,f=[];return function(){function e(){o||"meta"!=c.event.type||"setTempo"!=c.event.subtype||(a=6e7/c.event.microsecondsPerBeat);var e=0;c.ticksToEvent>0&&(e=c.ticksToEvent/s/(a/60));var n=1e3*e*t||0;f.push([c,n]),c=l()}if(c=l())for(;c;)e()}(),{getData:function(){return clone(f)}}}function Stream(e){var t=0;function n(n){var r=e.charCodeAt(t);return n&&r>127&&(r-=256),t+=1,r}return{eof:function(){return t>=e.length},read:function(n){var r=e.substr(t,n);return t+=n,r},readInt32:function(){var n=(e.charCodeAt(t)<<24)+(e.charCodeAt(t+1)<<16)+(e.charCodeAt(t+2)<<8)+e.charCodeAt(t+3);return t+=4,n},readInt16:function(){var n=(e.charCodeAt(t)<<8)+e.charCodeAt(t+1);return t+=2,n},readInt8:n,readVarInt:function(){for(var e=0;;){var t=n();if(!(128&t))return e+t;e+=127&t,e<<=7}}}}!function(){var e="undefined"!=typeof exports?exports:this,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function n(e){this.message=e}n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.btoa||(e.btoa=function(e){for(var r,i,a=0,o=t,s="";e.charAt(0|a)||(o="=",a%1);s+=o.charAt(63&r>>8-a%1*8)){if((i=e.charCodeAt(a+=.75))>255)throw new n("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");r=r<<8|i}return s}),e.atob||(e.atob=function(e){if((e=e.replace(/=+$/,"")).length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,a=0,o=0,s="";i=e.charAt(o++);~i&&(r=a%4?64*r+i:i,a++%4)?s+=String.fromCharCode(255&r>>(-2*a&6)):0)i=t.indexOf(i);return s})}();
/**
 * @license -------------------------------------------------------------------
 *   module: Base64Binary
 *      src: http://blog.danguer.com/2011/10/24/base64-binary-decoding-in-javascript/
 *  license: Simplified BSD License
 * -------------------------------------------------------------------
 * Copyright 2011, Daniel Guerrero. All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     - Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     - Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL DANIEL GUERRERO BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
var Base64Binary={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeArrayBuffer:function(e){var t=Math.ceil(3*e.length/4),n=new ArrayBuffer(t);return this.decode(e,n),n},decode:function(e,t){var n=this._keyStr.indexOf(e.charAt(e.length-1)),r=this._keyStr.indexOf(e.charAt(e.length-1)),i=Math.ceil(3*e.length/4);64==n&&i--,64==r&&i--;var a,o,s,u,l,c,f,d=0,h=0;for(a=t?new Uint8Array(t):new Uint8Array(i),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),d=0;d<i;d+=3)o=this._keyStr.indexOf(e.charAt(h++))<<2|(l=this._keyStr.indexOf(e.charAt(h++)))>>4,s=(15&l)<<4|(c=this._keyStr.indexOf(e.charAt(h++)))>>2,u=(3&c)<<6|(f=this._keyStr.indexOf(e.charAt(h++))),a[d]=o,64!=c&&(a[d+1]=s),64!=f&&(a[d+2]=u);return a}};
/**
 * @license -------------------------------------------------------------------
 *   module: WebAudioShim - Fix naming issues for WebAudioAPI supports
 *      src: https://github.com/Dinahmoe/webaudioshim
 *   author: Dinahmoe AB
 * -------------------------------------------------------------------
 * Copyright (c) 2012 DinahMoe AB
 * 
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 * 
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */if(window.AudioContext=window.AudioContext||window.webkitAudioContext||null,window.OfflineAudioContext=window.OfflineAudioContext||window.webkitOfflineAudioContext||null,function(e){var t,n,r,i=function(e){return"[object Function]"===Object.prototype.toString.call(e)||"[object AudioContextConstructor]"===Object.prototype.toString.call(e)};i(e)&&(n=new e).destination&&n.sampleRate&&(t=e.prototype,r=Object.getPrototypeOf(n.createBufferSource()),i(r.start)||i(r.noteOn)&&(r.start=function(e,t,n){switch(arguments.length){case 0:throw new Error("Not enough arguments.");case 1:this.noteOn(e);break;case 2:if(!this.buffer)throw new Error("Missing AudioBuffer");this.noteGrainOn(e,t,this.buffer.duration-t);break;case 3:this.noteGrainOn(e,t,n)}}),i(r.noteOn)||(r.noteOn=r.start),i(r.noteGrainOn)||(r.noteGrainOn=r.start),i(r.stop)||(r.stop=r.noteOff),i(r.noteOff)||(r.noteOff=r.stop),[["createGainNode","createGain"],["createDelayNode","createDelay"],["createJavaScriptNode","createScriptProcessor"]].forEach(function(e){for(var t,n;e.length;)t=e.pop(),i(this[t])?this[e.pop()]=this[t]:(n=e.pop(),this[t]=this[n])},t))}(window.AudioContext),function(e){"use strict";var t,n,r,i,a,o;function s(){}s.prototype.then=function(e,t){this.accept=e,this.reject=t},s.prototype.succeed=function(e){this.accept&&this.accept(e)},s.prototype.fail=function(e){this.reject&&this.reject(e)};function u(){this.inputInUse=!1,this.outputInUse=!1;var e=document.createElement("object");e.id="_Jazz"+Math.random()+"ie",e.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",this.activeX=e;var t=document.createElement("object");t.id="_Jazz"+Math.random(),t.type="audio/x-jazz",e.appendChild(t),this.objRef=t;var n=document.createElement("p");n.appendChild(document.createTextNode("This page requires the "));var r=document.createElement("a");r.appendChild(document.createTextNode("Jazz plugin")),r.href="http://jazz-soft.net/",n.appendChild(r),n.appendChild(document.createTextNode(".")),t.appendChild(n);if(!(i=document.getElementById("MIDIPlugin"))){var i;(i=document.createElement("div")).id="MIDIPlugin",i.style.position="absolute",i.style.visibility="hidden",i.style.left="-9999px",i.style.top="-9999px",document.body.appendChild(i)}i.appendChild(e),this.objRef.isJazz?this._Jazz=this.objRef:this.activeX.isJazz?this._Jazz=this.activeX:this._Jazz=null,this._Jazz&&(this._Jazz._jazzTimeZero=this._Jazz.Time(),this._Jazz._perfTimeZero=window.performance.now())}t=function(){return(new n)._promise},n=function(){this._jazzInstances=new Array,this._jazzInstances.push(new u),this._promise=new s,this._jazzInstances[0]._Jazz?(this._Jazz=this._jazzInstances[0]._Jazz,window.setTimeout(r.bind(this),3)):window.setTimeout(function(){this._promise&&this._promise.fail({code:1})}.bind(this),3)},r=function(){this._promise&&this._promise.succeed(this)};n.prototype.inputs=function(){if(!this._Jazz)return null;for(var e=this._Jazz.MidiInList(),t=new Array(e.length),n=0;n<e.length;n++)t[n]=new i(this,e[n],n);return t},n.prototype.outputs=function(){if(!this._Jazz)return null;for(var e=this._Jazz.MidiOutList(),t=new Array(e.length),n=0;n<e.length;n++)t[n]=new a(this,e[n],n);return t},(i=function(e,t,n){this._listeners=[],this._midiAccess=e,this._index=n,this._inLongSysexMessage=!1,this._sysexBuffer=new Uint8Array,this.id=n+"."+t,this.manufacturer="",this.name=t,this.type="input",this.version="",this.onmidimessage=null;for(var r=null,i=0;i<e._jazzInstances.length&&!r;i++)e._jazzInstances[i].inputInUse||(r=e._jazzInstances[i]);r||(r=new u,e._jazzInstances.push(r)),r.inputInUse=!0,this._jazzInstance=r._Jazz,this._input=this._jazzInstance.MidiInOpen(this._index,o.bind(this))}).prototype.addEventListener=function(e,t,n){if("midimessage"===e){for(var r=0;r<this._listeners.length;r++)if(this._listeners[r]==t)return;this._listeners.push(t)}},i.prototype.removeEventListener=function(e,t,n){if("midimessage"===e)for(var r=0;r<this._listeners.length;r++)if(this._listeners[r]==t)return void this._listeners.splice(r,1)},i.prototype.preventDefault=function(){this._pvtDef=!0},i.prototype.dispatchEvent=function(e){this._pvtDef=!1;for(var t=0;t<this._listeners.length;t++)this._listeners[t].handleEvent?this._listeners[t].handleEvent.bind(this)(e):this._listeners[t].bind(this)(e);return this.onmidimessage&&this.onmidimessage(e),this._pvtDef},i.prototype.appendToSysexBuffer=function(e){var t=this._sysexBuffer.length,n=new Uint8Array(t+e.length);n.set(this._sysexBuffer),n.set(e,t),this._sysexBuffer=n},i.prototype.bufferLongSysex=function(e,t){for(var n=t;n<e.length;){if(247==e[n])return n++,this.appendToSysexBuffer(e.slice(t,n)),n;n++}return this.appendToSysexBuffer(e.slice(t,n)),this._inLongSysexMessage=!0,n},o=function(e,t){var n,r=0,i=!1;for(n=0;n<t.length;n+=r){if(this._inLongSysexMessage){if(247!=t[(n=this.bufferLongSysex(t,n))-1])return;i=!0}else switch(i=!1,240&t[n]){case 128:case 144:case 160:case 176:case 224:r=3;break;case 192:case 208:r=2;break;case 240:switch(t[n]){case 240:if(247!=t[(n=this.bufferLongSysex(t,n))-1])return;i=!0;break;case 241:case 243:r=2;break;case 242:r=3;break;default:r=1}}var a=document.createEvent("Event");a.initEvent("midimessage",!1,!1),a.receivedTime=parseFloat(e.toString())+this._jazzInstance._perfTimeZero,i||this._inLongSysexMessage?(a.data=new Uint8Array(this._sysexBuffer),this._sysexBuffer=new Uint8Array(0),this._inLongSysexMessage=!1):a.data=new Uint8Array(t.slice(n,r+n)),this.dispatchEvent(a)}};(a=function(e,t,n){this._listeners=[],this._midiAccess=e,this._index=n,this.id=n+"."+t,this.manufacturer="",this.name=t,this.type="output",this.version="";for(var r=null,i=0;i<e._jazzInstances.length&&!r;i++)e._jazzInstances[i].outputInUse||(r=e._jazzInstances[i]);r||(r=new u,e._jazzInstances.push(r)),r.outputInUse=!0,this._jazzInstance=r._Jazz,this._jazzInstance.MidiOutOpen(this.name)}).prototype.send=function(e,t){var n=0;if(0===e.length)return!1;if(t&&(n=Math.floor(t-window.performance.now())),t&&n>1){var r=new Object;r.jazz=this._jazzInstance,r.data=e,window.setTimeout(function(){this.jazz.MidiOutLong(this.data)}.bind(r),n)}else this._jazzInstance.MidiOutLong(e);return!0},window.navigator.requestMIDIAccess||(window.navigator.requestMIDIAccess=t)}(window),function(e){var t,n={};"performance"in e&&"now"in e.performance||("performance"in e||Object.defineProperty(e,"performance",{get:function(){return n}}),t=function(){for(var t,n=["moz","webkit","o","ms"],r=n.length,i={value:(t=Date.now(),function(){return Date.now()-t})};r>=0;r--)if(n[r]+"Now"in e.performance)return i.value=function(t){return function(){e.performance[t]()}}(n[r]+"Now"),i;return"timing"in e.performance&&"connectStart"in e.performance.timing&&(i.value=(e.performance.timing.connectStart,function(){Date.now()})),i}(),Object.defineProperty(e.performance,"now",t))}(window),function(e){var t,n,r=function(r){e.AudioContext||(e.AudioContext=e.webkitAudioContext),r||(console.log("tuna.js: Missing audio context! Creating a new context for you."),r=e.AudioContext&&new e.AudioContext),t=r,n=this},i=function(e,t){e.value=t},a=Object.create(null,{activate:{writable:!0,value:function(e){e?(this.input.disconnect(),this.input.connect(this.activateNode),this.activateCallback&&this.activateCallback(e)):(this.input.disconnect(),this.input.connect(this.output))}},bypass:{get:function(){return this._bypass},set:function(e){this._lastBypassValue!==e&&(this._bypass=e,this.activate(!e),this._lastBypassValue=e)}},connect:{value:function(e){this.output.connect(e)}},disconnect:{value:function(e){this.output.disconnect(e)}},connectInOrder:{value:function(e){for(var t=e.length-1;t--;){if(!e[t].connect)return console.error("AudioNode.connectInOrder: TypeError: Not an AudioNode.",e[t]);e[t+1].input?e[t].connect(e[t+1].input):e[t].connect(e[t+1])}}},getDefaults:{value:function(){var e={};for(var t in this.defaults)e[t]=this.defaults[t].value;return e}},getValues:{value:function(){var e={};for(var t in this.defaults)e[t]=this[t];return e}},automate:{value:function(e,n,r,i){var a,o=i?~~(i/1e3):t.currentTime,s=r?~~(r/1e3):0,u=this.defaults[e],l=this[e];l?u.automatable?(r?(a="linearRampToValueAtTime",l.cancelScheduledValues(o),l.setValueAtTime(l.value,o)):a="setValueAtTime",l[a](n,s+o)):l=n:console.error("Invalid Property for "+this.name)}}});function o(e){return Math.max(0,Math.round(100*Math.pow(2,e/6))/100)}function s(e,t){var n,r,i=0,a=0,o=0,s=0;return n=e.toExponential().match(/^.\.?(.*)e(.+)$/),i=parseInt(n[2],10)-(n[1]+"").length,n=t.toExponential().match(/^.\.?(.*)e(.+)$/),(a=parseInt(n[2],10)-(n[1]+"").length)>i&&(i=a),r=e%t,i<-100||i>20?(o=Math.round(Math.log(r)/Math.log(10)),(r/(s=Math.pow(10,o))).toFixed(o-i)*s):parseFloat(r.toFixed(-i))}function u(e){return(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))}r.toString=r.prototype.toString=function(){return"You are running Tuna version 0.1 by Dinahmoe!"},r.prototype.Filter=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.activateNode=t.createGain(),this.filter=t.createBiquadFilter(),this.output=t.createGain(),this.activateNode.connect(this.filter),this.filter.connect(this.output),this.frequency=e.frequency||this.defaults.frequency.value,this.Q=e.resonance||this.defaults.Q.value,this.filterType=e.filterType||this.defaults.filterType.value,this.gain=e.gain||this.defaults.gain.value,this.bypass=e.bypass||!1},r.prototype.Filter.prototype=Object.create(a,{name:{value:"Filter"},defaults:{writable:!0,value:{frequency:{value:800,min:20,max:22050,automatable:!0},Q:{value:1,min:.001,max:100,automatable:!0},gain:{value:0,min:-40,max:40,automatable:!0},bypass:{value:!0,automatable:!1,type:"boolean"},filterType:{value:1,min:0,max:7,automatable:!1,type:"int"}}},filterType:{enumerable:!0,get:function(){return this.filter.type},set:function(e){this.filter.type=e}},Q:{enumerable:!0,get:function(){return this.filter.Q},set:function(e){this.filter.Q.value=e}},gain:{enumerable:!0,get:function(){return this.filter.gain},set:function(e){this.filter.gain.value=e}},frequency:{enumerable:!0,get:function(){return this.filter.frequency},set:function(e){this.filter.frequency.value=e}}}),r.prototype.Bitcrusher=function(e){e||(e=this.getDefaults()),this.bufferSize=e.bufferSize||this.defaults.bufferSize.value,this.input=t.createGain(),this.activateNode=t.createGain(),this.processor=t.createScriptProcessor(this.bufferSize,1,1),this.output=t.createGain(),this.activateNode.connect(this.processor),this.processor.connect(this.output);var n=0,r=0;this.processor.onaudioprocess=function(e){for(var t=e.inputBuffer.getChannelData(0),i=e.outputBuffer.getChannelData(0),a=Math.pow(.5,this.bits),o=0;o<t.length;o++)(n+=this.normfreq)>=1&&(n-=1,r=a*Math.floor(t[o]/a+.5)),i[o]=r},this.bits=e.bits||this.defaults.bits.value,this.normfreq=e.normfreq||this.defaults.normfreq.value,this.bypass=e.bypass||!1},r.prototype.Bitcrusher.prototype=Object.create(a,{name:{value:"Bitcrusher"},defaults:{writable:!0,value:{bits:{value:4,min:1,max:16,automatable:!1,type:"int"},bufferSize:{value:4096,min:256,max:16384,automatable:!1,type:"int"},bypass:{value:!1,automatable:!1,type:"boolean"},normfreq:{value:.1,min:1e-4,max:1,automatable:!1}}},bits:{enumerable:!0,get:function(){return this.processor.bits},set:function(e){this.processor.bits=e}},normfreq:{enumerable:!0,get:function(){return this.processor.normfreq},set:function(e){this.processor.normfreq=e}}}),r.prototype.Cabinet=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.activateNode=t.createGain(),this.convolver=this.newConvolver(e.impulsePath||"../impulses/impulse_guitar.wav"),this.makeupNode=t.createGain(),this.output=t.createGain(),this.activateNode.connect(this.convolver.input),this.convolver.output.connect(this.makeupNode),this.makeupNode.connect(this.output),this.makeupGain=e.makeupGain||this.defaults.makeupGain,this.bypass=e.bypass||!1},r.prototype.Cabinet.prototype=Object.create(a,{name:{value:"Cabinet"},defaults:{writable:!0,value:{makeupGain:{value:1,min:0,max:20,automatable:!0},bypass:{value:!1,automatable:!1,type:"boolean"}}},makeupGain:{enumerable:!0,get:function(){return this.makeupNode.gain},set:function(e){this.makeupNode.gain.value=e}},newConvolver:{value:function(e){return new n.Convolver({impulse:e,dryLevel:0,wetLevel:1})}}}),r.prototype.Chorus=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.attenuator=this.activateNode=t.createGain(),this.splitter=t.createChannelSplitter(2),this.delayL=t.createDelayNode(),this.delayR=t.createDelayNode(),this.feedbackGainNodeLR=t.createGain(),this.feedbackGainNodeRL=t.createGain(),this.merger=t.createChannelMerger(2),this.output=t.createGain(),this.lfoL=new n.LFO({target:this.delayL.delayTime,callback:i}),this.lfoR=new n.LFO({target:this.delayR.delayTime,callback:i}),this.input.connect(this.attenuator),this.attenuator.connect(this.output),this.attenuator.connect(this.splitter),this.splitter.connect(this.delayL,0),this.splitter.connect(this.delayR,1),this.delayL.connect(this.feedbackGainNodeLR),this.delayR.connect(this.feedbackGainNodeRL),this.feedbackGainNodeLR.connect(this.delayR),this.feedbackGainNodeRL.connect(this.delayL),this.delayL.connect(this.merger,0,0),this.delayR.connect(this.merger,0,1),this.merger.connect(this.output),this.feedback=e.feedback||this.defaults.feedback.value,this.rate=e.rate||this.defaults.rate.value,this.delay=e.delay||this.defaults.delay.value,this.depth=e.depth||this.defaults.depth.value,this.lfoR.phase=Math.PI/2,this.attenuator.gain.value=.6934,this.lfoL.activate(!0),this.lfoR.activate(!0),this.bypass=e.bypass||!1},r.prototype.Chorus.prototype=Object.create(a,{name:{value:"Chorus"},defaults:{writable:!0,value:{feedback:{value:.4,min:0,max:.95,automatable:!1},delay:{value:.0045,min:0,max:1,automatable:!1},depth:{value:.7,min:0,max:1,automatable:!1},rate:{value:1.5,min:0,max:8,automatable:!1},bypass:{value:!0,automatable:!1,type:"boolean"}}},delay:{enumerable:!0,get:function(){return this._delay},set:function(e){this._delay=2*Math.pow(10,e)*2e-4,this.lfoL.offset=this._delay,this.lfoR.offset=this._delay,this._depth=this._depth}},depth:{enumerable:!0,get:function(){return this._depth},set:function(e){this._depth=e,this.lfoL.oscillation=this._depth*this._delay,this.lfoR.oscillation=this._depth*this._delay}},feedback:{enumerable:!0,get:function(){return this._feedback},set:function(e){this._feedback=e,this.feedbackGainNodeLR.gain.value=this._feedback,this.feedbackGainNodeRL.gain.value=this._feedback}},rate:{enumerable:!0,get:function(){return this._rate},set:function(e){this._rate=e,this.lfoL.frequency=this._rate,this.lfoR.frequency=this._rate}}}),r.prototype.Compressor=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.compNode=this.activateNode=t.createDynamicsCompressor(),this.makeupNode=t.createGain(),this.output=t.createGain(),this.compNode.connect(this.makeupNode),this.makeupNode.connect(this.output),this.automakeup=e.automakeup||this.defaults.automakeup.value,this.makeupGain=e.makeupGain||this.defaults.makeupGain.value,this.threshold=e.threshold||this.defaults.threshold.value,this.release=e.release||this.defaults.release.value,this.attack=e.attack||this.defaults.attack.value,this.ratio=e.ratio||this.defaults.ratio.value,this.knee=e.knee||this.defaults.knee.value,this.bypass=e.bypass||!1},r.prototype.Compressor.prototype=Object.create(a,{name:{value:"Compressor"},defaults:{writable:!0,value:{threshold:{value:-20,min:-60,max:0,automatable:!0},release:{value:250,min:10,max:2e3,automatable:!0},makeupGain:{value:1,min:1,max:100,automatable:!0},attack:{value:1,min:0,max:1e3,automatable:!0},ratio:{value:4,min:1,max:50,automatable:!0},knee:{value:5,min:0,max:40,automatable:!0},automakeup:{value:!1,automatable:!1,type:"boolean"},bypass:{value:!0,automatable:!1,type:"boolean"}}},computeMakeup:{value:function(){var e=this.compNode;return-(e.threshold.value-e.threshold.value/e.ratio.value)/4}},automakeup:{enumerable:!0,get:function(){return this._automakeup},set:function(e){this._automakeup=e,this._automakeup&&(this.makeupGain=this.computeMakeup())}},threshold:{enumerable:!0,get:function(){return this.compNode.threshold},set:function(e){this.compNode.threshold.value=e,this._automakeup&&(this.makeupGain=this.computeMakeup())}},ratio:{enumerable:!0,get:function(){return this.compNode.ratio},set:function(e){this.compNode.ratio.value=e,this._automakeup&&(this.makeupGain=this.computeMakeup())}},knee:{enumerable:!0,get:function(){return this.compNode.knee},set:function(e){this.compNode.knee.value=e,this._automakeup&&(this.makeupGain=this.computeMakeup())}},attack:{enumerable:!0,get:function(){return this.compNode.attack},set:function(e){this.compNode.attack.value=e/1e3}},release:{enumerable:!0,get:function(){return this.compNode.release},set:function(e){this.compNode.release=e/1e3}},makeupGain:{enumerable:!0,get:function(){return this.makeupNode.gain},set:function(e){this.makeupNode.gain.value=o(e)}}}),r.prototype.Convolver=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.activateNode=t.createGain(),this.convolver=t.createConvolver(),this.dry=t.createGain(),this.filterLow=t.createBiquadFilter(),this.filterHigh=t.createBiquadFilter(),this.wet=t.createGain(),this.output=t.createGain(),this.activateNode.connect(this.filterLow),this.activateNode.connect(this.dry),this.filterLow.connect(this.filterHigh),this.filterHigh.connect(this.convolver),this.convolver.connect(this.wet),this.wet.connect(this.output),this.dry.connect(this.output),this.dryLevel=e.dryLevel||this.defaults.dryLevel.value,this.wetLevel=e.wetLevel||this.defaults.wetLevel.value,this.highCut=e.highCut||this.defaults.highCut.value,this.buffer=e.impulse||"../impulses/ir_rev_short.wav",this.lowCut=e.lowCut||this.defaults.lowCut.value,this.level=e.level||this.defaults.level.value,this.filterHigh.type=this.filterHigh.LOWPASS,this.filterLow.type=this.filterHigh.HIGHPASS,this.bypass=e.bypass||!1},r.prototype.Convolver.prototype=Object.create(a,{name:{value:"Convolver"},defaults:{writable:!0,value:{highCut:{value:22050,min:20,max:22050,automatable:!0},lowCut:{value:20,min:20,max:22050,automatable:!0},dryLevel:{value:1,min:0,max:1,automatable:!0},wetLevel:{value:1,min:0,max:1,automatable:!0},level:{value:1,min:0,max:1,automatable:!0}}},lowCut:{get:function(){return this.filterLow.frequency},set:function(e){this.filterLow.frequency.value=e}},highCut:{get:function(){return this.filterHigh.frequency},set:function(e){this.filterHigh.frequency.value=e}},level:{get:function(){return this.output.gain},set:function(e){this.output.gain.value=e}},dryLevel:{get:function(){return this.dry.gain},set:function(e){this.dry.gain.value=e}},wetLevel:{get:function(){return this.wet.gain},set:function(e){this.wet.gain.value=e}},buffer:{enumerable:!1,get:function(){return this.convolver.buffer},set:function(e){var n=this.convolver,r=new XMLHttpRequest;e?(r.open("GET",e,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){4===r.readyState&&(r.status<300&&r.status>199||302===r.status)&&t.decodeAudioData(r.response,function(e){n.buffer=e},function(e){e&&console.log("Tuna.Convolver.setBuffer: Error decoding data"+e)})},r.send(null)):console.log("Tuna.Convolver.setBuffer: Missing impulse path!")}}}),r.prototype.Delay=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.activateNode=t.createGain(),this.dry=t.createGain(),this.wet=t.createGain(),this.filter=t.createBiquadFilter(),this.delay=t.createDelayNode(),this.feedbackNode=t.createGain(),this.output=t.createGain(),this.activateNode.connect(this.delay),this.activateNode.connect(this.dry),this.delay.connect(this.filter),this.filter.connect(this.feedbackNode),this.feedbackNode.connect(this.delay),this.feedbackNode.connect(this.wet),this.wet.connect(this.output),this.dry.connect(this.output),this.delayTime=e.delayTime||this.defaults.delayTime.value,this.feedback=e.feedback||this.defaults.feedback.value,this.wetLevel=e.wetLevel||this.defaults.wetLevel.value,this.dryLevel=e.dryLevel||this.defaults.dryLevel.value,this.cutoff=e.cutoff||this.defaults.cutoff.value,this.filter.type=this.filter.LOWPASS,this.bypass=e.bypass||!1},r.prototype.Delay.prototype=Object.create(a,{name:{value:"Delay"},defaults:{writable:!0,value:{delayTime:{value:100,min:20,max:1e3,automatable:!1},feedback:{value:.45,min:0,max:.9,automatable:!0},cutoff:{value:2e4,min:20,max:2e4,automatable:!0},wetLevel:{value:.5,min:0,max:1,automatable:!0},dryLevel:{value:1,min:0,max:1,automatable:!0}}},delayTime:{enumerable:!0,get:function(){return this.delay.delayTime},set:function(e){this.delay.delayTime.value=e/1e3}},wetLevel:{enumerable:!0,get:function(){return this.wet.gain},set:function(e){this.wet.gain.value=e}},dryLevel:{enumerable:!0,get:function(){return this.dry.gain},set:function(e){this.dry.gain.value=e}},feedback:{enumerable:!0,get:function(){return this.feedbackNode.gain},set:function(e){this.feedbackNode.gain.value=e}},cutoff:{enumerable:!0,get:function(){return this.filter.frequency},set:function(e){this.filter.frequency.value=e}}}),r.prototype.MoogFilter=function(e){e||(e=this.getDefaults()),this.bufferSize=e.bufferSize||this.defaults.bufferSize.value,this.input=t.createGain(),this.activateNode=t.createGain(),this.processor=t.createScriptProcessor(this.bufferSize,1,1),this.output=t.createGain(),this.activateNode.connect(this.processor),this.processor.connect(this.output);var n,r,i,a,o,s,u,l;n=r=i=a=o=s=u=l=0,this.processor.onaudioprocess=function(e){for(var t=e.inputBuffer.getChannelData(0),c=e.outputBuffer.getChannelData(0),f=1.16*this.cutoff,d=this.resonance*(1-.15*f*f),h=0;h<t.length;h++)t[h]-=l*d,t[h]*=f*f*.35013*(f*f),o=t[h]+.3*n+(1-f)*o,n=t[h],s=o+.3*r+(1-f)*s,r=o,u=s+.3*i+(1-f)*u,i=s,l=u+.3*a+(1-f)*l,a=u,c[h]=l},this.cutoff=e.cutoff||this.defaults.cutoff.value,this.resonance=e.resonance||this.defaults.resonance.value,this.bypass=e.bypass||!1},r.prototype.MoogFilter.prototype=Object.create(a,{name:{value:"MoogFilter"},defaults:{writable:!0,value:{bufferSize:{value:4096,min:256,max:16384,automatable:!1,type:"int"},bypass:{value:!1,automatable:!1,type:"boolean"},cutoff:{value:.065,min:1e-4,max:1,automatable:!1},resonance:{value:3.5,min:0,max:4,automatable:!1}}},cutoff:{enumerable:!0,get:function(){return this.processor.cutoff},set:function(e){this.processor.cutoff=e}},resonance:{enumerable:!0,get:function(){return this.processor.resonance},set:function(e){this.processor.resonance=e}}}),r.prototype.Overdrive=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.activateNode=t.createGain(),this.inputDrive=t.createGain(),this.waveshaper=t.createWaveShaper(),this.outputDrive=t.createGain(),this.output=t.createGain(),this.activateNode.connect(this.inputDrive),this.inputDrive.connect(this.waveshaper),this.waveshaper.connect(this.outputDrive),this.outputDrive.connect(this.output),this.ws_table=new Float32Array(this.k_nSamples),this.drive=e.drive||this.defaults.drive.value,this.outputGain=e.outputGain||this.defaults.outputGain.value,this.curveAmount=e.curveAmount||this.defaults.curveAmount.value,this.algorithmIndex=e.algorithmIndex||this.defaults.algorithmIndex.value,this.bypass=e.bypass||!1},r.prototype.Overdrive.prototype=Object.create(a,{name:{value:"Overdrive"},defaults:{writable:!0,value:{drive:{value:1,min:0,max:1,automatable:!0,type:"float",scaled:!0},outputGain:{value:1,min:0,max:1,automatable:!0,type:"float",scaled:!0},curveAmount:{value:.725,min:0,max:1,automatable:!1},algorithmIndex:{value:0,min:0,max:5,automatable:!1,type:"int"}}},k_nSamples:{value:8192},drive:{get:function(){return this.inputDrive.gain},set:function(e){this._drive=e}},curveAmount:{get:function(){return this._curveAmount},set:function(e){this._curveAmount=e,void 0===this._algorithmIndex&&(this._algorithmIndex=0),this.waveshaperAlgorithms[this._algorithmIndex](this._curveAmount,this.k_nSamples,this.ws_table),this.waveshaper.curve=this.ws_table}},outputGain:{get:function(){return this.outputDrive.gain},set:function(e){this._outputGain=o(e)}},algorithmIndex:{get:function(){return this._algorithmIndex},set:function(e){this._algorithmIndex=e>>0,this.curveAmount=this._curveAmount}},waveshaperAlgorithms:{value:[function(e,t,n){var r,i,a=2*(e=Math.min(e,.9999))/(1-e);for(r=0;r<t;r++)i=2*r/t-1,n[r]=(1+a)*i/(1+a*Math.abs(i))},function(e,t,n){var r,i,a;for(r=0;r<t;r++)i=2*r/t-1,a=(.5*Math.pow(i+1.4,2)-1)*a>=0?5.8:1.2,n[r]=u(a)},function(e,t,n){var r,i,a,o=1-e;for(r=0;r<t;r++)a=(i=2*r/t-1)<0?-Math.pow(Math.abs(i),o+.04):Math.pow(i,o),n[r]=u(2*a)},function(e,t,n){var r,i,a,o,s=1-e>.99?.99:1-e;for(r=0;r<t;r++)i=2*r/t-1,(o=Math.abs(i))<s?a=o:o>s?a=s+(o-s)/(1+Math.pow((o-s)/(1-s),2)):o>1&&(a=o),n[r]=(u=i,(0===u?1:Math.abs(u)/u)*a*(1/((s+1)/2)));var u},function(e,t,n){var r,i;for(r=0;r<t;r++)i=2*r/t-1,n[r]=i<-.08905?-.75*(1-Math.pow(1-(Math.abs(i)-.032857),12)+1/3*(Math.abs(i)-.032847))+.01:i>=-.08905&&i<.320018?i*i*-6.153+3.9375*i:.630035},function(e,t,n){var r,i,a=2+Math.round(14*e),o=Math.round(Math.pow(2,a-1));for(r=0;r<t;r++)i=2*r/t-1,n[r]=Math.round(i*o)/o}]}}),r.prototype.Phaser=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.splitter=this.activateNode=t.createChannelSplitter(2),this.filtersL=[],this.filtersR=[],this.feedbackGainNodeL=t.createGain(),this.feedbackGainNodeR=t.createGain(),this.merger=t.createChannelMerger(2),this.filteredSignal=t.createGain(),this.output=t.createGain(),this.lfoL=new n.LFO({target:this.filtersL,callback:this.callback}),this.lfoR=new n.LFO({target:this.filtersR,callback:this.callback});for(var r=this.stage;r--;)this.filtersL[r]=t.createBiquadFilter(),this.filtersR[r]=t.createBiquadFilter(),this.filtersL[r].type=this.filtersL[r].ALLPASS,this.filtersR[r].type=this.filtersR[r].ALLPASS;this.input.connect(this.splitter),this.input.connect(this.output),this.splitter.connect(this.filtersL[0],0,0),this.splitter.connect(this.filtersR[0],1,0),this.connectInOrder(this.filtersL),this.connectInOrder(this.filtersR),this.filtersL[this.stage-1].connect(this.feedbackGainNodeL),this.filtersL[this.stage-1].connect(this.merger,0,0),this.filtersR[this.stage-1].connect(this.feedbackGainNodeR),this.filtersR[this.stage-1].connect(this.merger,0,1),this.feedbackGainNodeL.connect(this.filtersL[0]),this.feedbackGainNodeR.connect(this.filtersR[0]),this.merger.connect(this.output),this.rate=e.rate||this.defaults.rate.value,this.baseModulationFrequency=e.baseModulationFrequency||this.defaults.baseModulationFrequency.value,this.depth=e.depth||this.defaults.depth.value,this.feedback=e.feedback||this.defaults.feedback.value,this.stereoPhase=e.stereoPhase||this.defaults.stereoPhase.value,this.lfoL.activate(!0),this.lfoR.activate(!0),this.bypass=e.bypass||!1},r.prototype.Phaser.prototype=Object.create(a,{name:{value:"Phaser"},stage:{value:4},defaults:{writable:!0,value:{rate:{value:.1,min:0,max:8,automatable:!1},depth:{value:.6,min:0,max:1,automatable:!1},feedback:{value:.7,min:0,max:1,automatable:!1},stereoPhase:{value:40,min:0,max:180,automatable:!1},baseModulationFrequency:{value:700,min:500,max:1500,automatable:!1}}},callback:{value:function(e,t){for(var n=0;n<4;n++)e[n].frequency.value=t}},depth:{get:function(){return this._depth},set:function(e){this._depth=e,this.lfoL.oscillation=this._baseModulationFrequency*this._depth,this.lfoR.oscillation=this._baseModulationFrequency*this._depth}},rate:{get:function(){return this._rate},set:function(e){this._rate=e,this.lfoL.frequency=this._rate,this.lfoR.frequency=this._rate}},baseModulationFrequency:{enumerable:!0,get:function(){return this._baseModulationFrequency},set:function(e){this._baseModulationFrequency=e,this.lfoL.offset=this._baseModulationFrequency,this.lfoR.offset=this._baseModulationFrequency,this._depth=this._depth}},feedback:{get:function(){return this._feedback},set:function(e){this._feedback=e,this.feedbackGainNodeL.gain.value=this._feedback,this.feedbackGainNodeR.gain.value=this._feedback}},stereoPhase:{get:function(){return this._stereoPhase},set:function(e){this._stereoPhase=e;var t=this.lfoL._phase+this._stereoPhase*Math.PI/180;t=s(t,2*Math.PI),this.lfoR._phase=t}}}),r.prototype.Tremolo=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.splitter=this.activateNode=t.createChannelSplitter(2),this.amplitudeL=t.createGain(),this.amplitudeR=t.createGain(),this.merger=t.createChannelMerger(2),this.output=t.createGain(),this.lfoL=new n.LFO({target:this.amplitudeL.gain,callback:i}),this.lfoR=new n.LFO({target:this.amplitudeR.gain,callback:i}),this.input.connect(this.splitter),this.splitter.connect(this.amplitudeL,0),this.splitter.connect(this.amplitudeR,1),this.amplitudeL.connect(this.merger,0,0),this.amplitudeR.connect(this.merger,0,1),this.merger.connect(this.output),this.rate=e.rate||this.defaults.rate.value,this.intensity=e.intensity||this.defaults.intensity.value,this.stereoPhase=e.stereoPhase||this.defaults.stereoPhase.value,this.lfoL.offset=1-this.intensity/2,this.lfoR.offset=1-this.intensity/2,this.lfoL.phase=this.stereoPhase*Math.PI/180,this.lfoL.activate(!0),this.lfoR.activate(!0),this.bypass=e.bypass||!1},r.prototype.Tremolo.prototype=Object.create(a,{name:{value:"Tremolo"},defaults:{writable:!0,value:{intensity:{value:.3,min:0,max:1,automatable:!1},stereoPhase:{value:0,min:0,max:180,automatable:!1},rate:{value:5,min:.1,max:11,automatable:!1}}},intensity:{enumerable:!0,get:function(){return this._intensity},set:function(e){this._intensity=e,this.lfoL.offset=1-this._intensity/2,this.lfoR.offset=1-this._intensity/2,this.lfoL.oscillation=this._intensity,this.lfoR.oscillation=this._intensity}},rate:{enumerable:!0,get:function(){return this._rate},set:function(e){this._rate=e,this.lfoL.frequency=this._rate,this.lfoR.frequency=this._rate}},stereoPhase:{enumerable:!0,get:function(){return this._rate},set:function(e){this._stereoPhase=e;var t=this.lfoL._phase+this._stereoPhase*Math.PI/180;t=s(t,2*Math.PI),this.lfoR.phase=t}}}),r.prototype.WahWah=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.activateNode=t.createGain(),this.envelopeFollower=new n.EnvelopeFollower({target:this,callback:function(e,t){e.sweep=t}}),this.filterBp=t.createBiquadFilter(),this.filterPeaking=t.createBiquadFilter(),this.output=t.createGain(),this.activateNode.connect(this.filterBp),this.filterBp.connect(this.filterPeaking),this.filterPeaking.connect(this.output),this.init(),this.automode=e.enableAutoMode||this.defaults.automode.value,this.resonance=e.resonance||this.defaults.resonance.value,this.sensitivity=e.sensitivity||this.defaults.sensitivity.value,this.baseFrequency=e.baseFrequency||this.defaults.baseFrequency.value,this.excursionOctaves=e.excursionOctaves||this.defaults.excursionOctaves.value,this.sweep=e.sweep||this.defaults.sweep.value,this.activateNode.gain.value=2,this.envelopeFollower.activate(!0),this.bypass=e.bypass||!1},r.prototype.WahWah.prototype=Object.create(a,{name:{value:"WahWah"},defaults:{writable:!0,value:{automode:{value:!0,automatable:!1,type:"boolean"},baseFrequency:{value:.5,min:0,max:1,automatable:!1},excursionOctaves:{value:2,min:1,max:6,automatable:!1},sweep:{value:.2,min:0,max:1,automatable:!1},resonance:{value:10,min:1,max:100,automatable:!1},sensitivity:{value:.5,min:-1,max:1,automatable:!1}}},activateCallback:{value:function(e){this.automode=e}},automode:{get:function(){return this._automode},set:function(e){this._automode=e,e?(this.activateNode.connect(this.envelopeFollower.input),this.envelopeFollower.activate(!0)):(this.envelopeFollower.activate(!1),this.activateNode.disconnect(),this.activateNode.connect(this.filterBp))}},sweep:{enumerable:!0,get:function(){return this._sweep.value},set:function(e){this._sweep=Math.pow(e>1?1:e<0?0:e,this._sensitivity),this.filterBp.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep,this.filterPeaking.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep}},baseFrequency:{enumerable:!0,get:function(){return this._baseFrequency},set:function(e){this._baseFrequency=50*Math.pow(10,2*e),this._excursionFrequency=Math.min(this.sampleRate/2,this.baseFrequency*Math.pow(2,this._excursionOctaves)),this.filterBp.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep,this.filterPeaking.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep}},excursionOctaves:{enumerable:!0,get:function(){return this._excursionOctaves},set:function(e){this._excursionOctaves=e,this._excursionFrequency=Math.min(this.sampleRate/2,this.baseFrequency*Math.pow(2,this._excursionOctaves)),this.filterBp.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep,this.filterPeaking.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep}},sensitivity:{enumerable:!0,get:function(){return this._sensitivity},set:function(e){this._sensitivity=Math.pow(10,e)}},resonance:{enumerable:!0,get:function(){return this._resonance},set:function(e){this._resonance=e,this.filterPeaking.Q=this._resonance}},init:{value:function(){this.output.gain.value=1,this.filterPeaking.type=5,this.filterBp.type=2,this.filterPeaking.frequency.value=100,this.filterPeaking.gain.value=20,this.filterPeaking.Q.value=5,this.filterBp.frequency.value=100,this.filterBp.Q.value=1,this.sampleRate=t.sampleRate}}}),r.prototype.EnvelopeFollower=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.jsNode=this.output=t.createScriptProcessor(this.buffersize,1,1),this.input.connect(this.output),this.attackTime=e.attackTime||this.defaults.attackTime.value,this.releaseTime=e.releaseTime||this.defaults.releaseTime.value,this._envelope=0,this.target=e.target||{},this.callback=e.callback||function(){}},r.prototype.EnvelopeFollower.prototype=Object.create(a,{name:{value:"EnvelopeFollower"},defaults:{value:{attackTime:{value:.003,min:0,max:.5,automatable:!1},releaseTime:{value:.5,min:0,max:.5,automatable:!1}}},buffersize:{value:256},envelope:{value:0},sampleRate:{value:44100},attackTime:{enumerable:!0,get:function(){return this._attackTime},set:function(e){this._attackTime=e,this._attackC=Math.exp(-1/this._attackTime*this.sampleRate/this.buffersize)}},releaseTime:{enumerable:!0,get:function(){return this._releaseTime},set:function(e){this._releaseTime=e,this._releaseC=Math.exp(-1/this._releaseTime*this.sampleRate/this.buffersize)}},callback:{get:function(){return this._callback},set:function(e){"function"==typeof e?this._callback=e:console.error("tuna.js: "+this.name+": Callback must be a function!")}},target:{get:function(){return this._target},set:function(e){this._target=e}},activate:{value:function(e){this.activated=e,e?(this.jsNode.connect(t.destination),this.jsNode.onaudioprocess=this.returnCompute(this)):(this.jsNode.disconnect(),this.jsNode.onaudioprocess=null)}},returnCompute:{value:function(e){return function(t){e.compute(t)}}},compute:{value:function(e){var t,n,r,i,a=e.inputBuffer.getChannelData(0).length,o=e.inputBuffer.numberOfChannels;if(n=r=i=0,o>1)for(i=0;i<a;++i)for(;n<o;++n)r+=(t=e.inputBuffer.getChannelData(n)[i])*t/o;else for(i=0;i<a;++i)r+=(t=e.inputBuffer.getChannelData(0)[i])*t;r=Math.sqrt(r),this._envelope<r?(this._envelope*=this._attackC,this._envelope+=(1-this._attackC)*r):(this._envelope*=this._releaseC,this._envelope+=(1-this._releaseC)*r),this._callback(this._target,this._envelope)}}}),r.prototype.LFO=function(e){this.output=t.createScriptProcessor(256,1,1),this.activateNode=t.destination,this.frequency=e.frequency||this.defaults.frequency.value,this.offset=e.offset||this.defaults.offset.value,this.oscillation=e.oscillation||this.defaults.oscillation.value,this.phase=e.phase||this.defaults.phase.value,this.target=e.target||{},this.output.onaudioprocess=this.callback(e.callback||function(){}),this.bypass=e.bypass||!1},r.prototype.LFO.prototype=Object.create(a,{name:{value:"LFO"},bufferSize:{value:256},sampleRate:{value:44100},defaults:{value:{frequency:{value:1,min:0,max:20,automatable:!1},offset:{value:.85,min:0,max:22049,automatable:!1},oscillation:{value:.3,min:-22050,max:22050,automatable:!1},phase:{value:0,min:0,max:2*Math.PI,automatable:!1}}},frequency:{get:function(){return this._frequency},set:function(e){this._frequency=e,this._phaseInc=2*Math.PI*this._frequency*this.bufferSize/this.sampleRate}},offset:{get:function(){return this._offset},set:function(e){this._offset=e}},oscillation:{get:function(){return this._oscillation},set:function(e){this._oscillation=e}},phase:{get:function(){return this._phase},set:function(e){this._phase=e}},target:{get:function(){return this._target},set:function(e){this._target=e}},activate:{value:function(e){e?this.output.connect(t.destination):this.output.disconnect(t.destination)}},callback:{value:function(e){var t=this;return function(){t._phase+=t._phaseInc,t._phase>2*Math.PI&&(t._phase=0),e(t._target,t._offset+t._oscillation*Math.sin(t._phase))}}}}),r.prototype.Panner=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.activateNode=t.createGain(),this.output=t.createGain(),this.panner=t.createPanner(),this.activateNode.connect(this.panner),this.panner.connect(this.output),this.bypass=e.bypass||!1,this.x=e.x||0,this.y=e.y||1,this.z=e.z||1,this.panningModel=e.panningModel||0,this.distanceModel=e.distanceModel||0};var l=function(e){return{enumerable:!0,get:function(){return this["_"+e]},set:function(t){this["_"+e]=t,this.panner.setPosition(this._x||0,this._y||0,this._z||0)}}},c=function(e){return{enumerable:!0,get:function(){return this["_"+e]},set:function(t){this["_"+e]=t,this.panner[e]=t}}},f=function(e,t,n,r){return{value:e,min:t,max:n,automatable:r}};r.prototype.Panner.prototype=Object.create(a,{name:{value:"Panner"},defaults:{writable:!0,value:{x:f(0,-20,20,!1),y:f(0,-20,20,!1),z:f(0,-20,20,!1),distanceModel:f(0,0,2,!1),panningModel:f(0,0,2,!1)}},x:l("x"),y:l("y"),z:l("z"),panningModel:c("panningModel"),distanceModel:c("distanceModel")}),r.prototype.Volume=function(e){e||(e=this.getDefaults()),this.input=t.createGain(),this.activateNode=t.createGain(),this.output=t.createGain(),this.activateNode.connect(this.output),this.bypass=e.bypass||!1,this.amount=e.amount||this.defaults.amount.value},r.prototype.Volume.prototype=Object.create(a,{name:{value:"Volume"},defaults:{writable:!0,value:{amount:f(0,0,2,!1)}},amount:{enumerable:!0,get:function(){return this._volume},set:function(e){this._volume=e,this.activateNode.gain.value=e}}}),r.prototype.Frequency=function(e){e||(e=this.getDefaults()),this.trebleFilter=t.createBiquadFilter(),this.trebleFilter.type=this.trebleFilter.HIGHSHELF,this.trebleFilter.frequency.value=8e3,this.trebleFilter.Q.value=0,this.midtoneFilter=t.createBiquadFilter(),this.midtoneFilter.type=this.midtoneFilter.PEAKING,this.midtoneFilter.frequency.value=1e3,this.midtoneFilter.Q.value=0,this.bassFilter=t.createBiquadFilter(),this.bassFilter.type=this.bassFilter.LOWSHELF,this.bassFilter.frequency.value=200,this.bassFilter.Q.value=0,this.input=t.createGain(),this.activateNode=t.createGain(),this.output=t.createGain(),this.activateNode.connect(this.bassFilter),this.bassFilter.connect(this.midtoneFilter),this.midtoneFilter.connect(this.trebleFilter),this.trebleFilter.connect(this.output),this.bypass=e.bypass||!1,this.volume=e.volume||!1,this.treble=e.treble||!1,this.midtone=e.midtone||!1,this.bass=e.bass||!1};var d=function(e,t){return{enumerable:!0,get:function(){return this["_"+e]},set:function(n){this["_"+e]=n,this[t||e+"Filter"].gain.value=n}}};r.prototype.Frequency.prototype=Object.create(a,{name:{value:"Frequency"},defaults:{writable:!0,value:{volume:f(1,0,2,!1),treble:f(0,-20,20,!1),midtone:f(0,-20,20,!1),bass:f(0,-20,20,!1)}},volume:d("volume","activateNode"),treble:d("treble"),midtone:d("midtone"),bass:d("bass")}),"function"==typeof define?define("Tuna",[],function(){return r}):e.Tuna=r}(this),void 0===Color)var Color={};if(void 0===Color.Space&&(Color.Space={}),function(){"use strict";var useEval=!1,functions={},shortcuts={"HEX24>HSL":"HEX24>RGB>HSL","HEX32>HSLA":"HEX32>RGBA>HSLA","HEX24>CMYK":"HEX24>RGB>CMY>CMYK","RGB>CMYK":"RGB>CMY>CMYK"},root=Color.Space=function(color,route){shortcuts[route]&&(route=shortcuts[route]);var r=route.split(">");if("object"==typeof color&&color[0]>=0){for(var type=r[0],tmp={},i=0;i<type.length;i++){var str=type.substr(i,1);tmp[str]=color[i]}color=tmp}if(functions[route])return functions[route](color);for(var f="color",pos=1,key=r[0];pos<r.length;pos++)pos>1&&(key=key.substr(key.indexOf("_")+1)),key+=(0===pos?"":"_")+r[pos],color=root[key](color),useEval&&(f="Color.Space."+key+"("+f+")");return useEval&&(functions[route]=eval("(function(color) { return "+f+" })")),color};root.RGB_W3=function(e){return"rgb("+(e.R>>0)+","+(e.G>>0)+","+(e.B>>0)+")"},root.RGBA_W3=function(e){var t="number"==typeof e.A?e.A/255:1;return"rgba("+(e.R>>0)+","+(e.G>>0)+","+(e.B>>0)+","+t+")"},root.W3_RGB=function(e){e=e.substr(4,e.length-5).split(",");return{R:parseInt(e[0]),G:parseInt(e[1]),B:parseInt(e[2])}},root.W3_RGBA=function(e){e=e.substr(5,e.length-6).split(",");return{R:parseInt(e[0]),G:parseInt(e[1]),B:parseInt(e[2]),A:255*parseFloat(e[3])}},root.HSL_W3=function(e){return"hsl("+(e.H+.5>>0)+","+(e.S+.5>>0)+"%,"+(e.L+.5>>0)+"%)"},root.HSLA_W3=function(e){var t="number"==typeof e.A?e.A/255:1;return"hsla("+(e.H+.5>>0)+","+(e.S+.5>>0)+"%,"+(e.L+.5>>0)+"%,"+t+")"},root.W3_HSL=function(e){e=e.substr(4,e.length-5).split(",");return{H:parseInt(e[0]),S:parseInt(e[1]),L:parseInt(e[2])}},root.W3_HSLA=function(e){e=e.substr(5,e.length-6).split(",");return{H:parseInt(e[0]),S:parseInt(e[1]),L:parseInt(e[2]),A:255*parseFloat(e[3])}},root.W3_HEX=root.W3_HEX24=function(e){return"#"===e.substr(0,1)&&(e=e.substr(1)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),parseInt("0x"+e)},root.W3_HEX32=function(e){return"#"===e.substr(0,1)&&(e=e.substr(1)),6===e.length?parseInt("0xFF"+e):parseInt("0x"+e)},root.HEX_W3=root.HEX24_W3=function(e,t){t||(t=6),e||(e=0);for(var n=e.toString(16),r=n.length;r<t;)n="0"+n,r++;for(r=n.length;r>t;)n=n.substr(1),r--;return"#"+n},root.HEX32_W3=function(e){return root.HEX_W3(e,8)},root.HEX_RGB=root.HEX24_RGB=function(e){return{R:e>>16,G:e>>8&255,B:255&e}},root.HEX32_RGBA=function(e){return{R:e>>>16&255,G:e>>>8&255,B:255&e,A:e>>>24}},root.RGBA_HEX32=function(e){return(e.A<<24|e.R<<16|e.G<<8|e.B)>>>0},root.RGB_HEX24=root.RGB_HEX=function(e){return e.R<0&&(e.R=0),e.G<0&&(e.G=0),e.B<0&&(e.B=0),e.R>255&&(e.R=255),e.G>255&&(e.G=255),e.B>255&&(e.B=255),e.R<<16|e.G<<8|e.B},root.RGB_CMY=function(e){return{C:1-e.R/255,M:1-e.G/255,Y:1-e.B/255}},root.RGBA_HSLA=root.RGB_HSL=function(e){var t,n,r=e.R/255,i=e.G/255,a=e.B/255,o=Math.min(r,i,a),s=Math.max(r,i,a),u=s-o,l=(s+o)/2;if(0===u)t=0,n=0;else{n=l<.5?u/(s+o):u/(2-s-o);var c=((s-r)/6+u/2)/u,f=((s-i)/6+u/2)/u,d=((s-a)/6+u/2)/u;r===s?t=d-f:i===s?t=1/3+c-d:a===s&&(t=2/3+f-c),t<0&&(t+=1),t>1&&(t-=1)}return{H:360*t,S:100*n,L:100*l,A:e.A}},root.RGBA_HSVA=root.RGB_HSV=function(e){var t,n,r=e.R/255,i=e.G/255,a=e.B/255,o=Math.min(r,i,a),s=Math.max(r,i,a),u=s-o;if(0===u)t=0,n=0;else{n=u/s;var l=((s-r)/6+u/2)/u,c=((s-i)/6+u/2)/u,f=((s-a)/6+u/2)/u;r===s?t=f-c:i===s?t=1/3+l-f:a===s&&(t=2/3+c-l),t<0&&(t+=1),t>1&&(t-=1)}return{H:360*t,S:100*n,V:100*s,A:e.A}},root.CMY_RGB=function(e){return{R:Math.max(0,255*(1-e.C)),G:Math.max(0,255*(1-e.M)),B:Math.max(0,255*(1-e.Y))}},root.CMY_CMYK=function(e){var t=e.C,n=e.M,r=e.Y,i=Math.min(r,Math.min(n,Math.min(t,1)));return{C:t=Math.round((t-i)/(1-i)*100),M:n=Math.round((n-i)/(1-i)*100),Y:r=Math.round((r-i)/(1-i)*100),K:i=Math.round(100*i)}},root.CMYK_CMY=function(e){return{C:e.C*(1-e.K)+e.K,M:e.M*(1-e.K)+e.K,Y:e.Y*(1-e.K)+e.K}},root.HSLA_RGBA=root.HSL_RGB=function(e){var t,n,r,i,a,o,s=e.H/360,u=e.S/100,l=e.L/100;return 0===u?t=n=r=l:(i=2*l-(a=l<.5?l*(1+u):l+u-u*l),(o=s+1/3)<0&&(o+=1),o>1&&(o-=1),t=6*o<1?i+6*(a-i)*o:2*o<1?a:3*o<2?i+(a-i)*(2/3-o)*6:i,(o=s)<0&&(o+=1),o>1&&(o-=1),n=6*o<1?i+6*(a-i)*o:2*o<1?a:3*o<2?i+(a-i)*(2/3-o)*6:i,(o=s-1/3)<0&&(o+=1),o>1&&(o-=1),r=6*o<1?i+6*(a-i)*o:2*o<1?a:3*o<2?i+(a-i)*(2/3-o)*6:i),{R:255*t,G:255*n,B:255*r,A:e.A}},root.HSVA_RGBA=root.HSV_RGB=function(e){var t,n,r,i,a,o,s=e.H/360,u=e.S/100,l=e.V/100;if(0===u)t=n=r=Math.round(255*l);else switch(s>=1&&(s=0),i=(s*=6)-Math.floor(s),a=Math.round(255*l*(1-u)),r=Math.round(255*l*(1-u*i)),o=Math.round(255*l*(1-u*(1-i))),l=Math.round(255*l),Math.floor(s)){case 0:t=l,n=o,r=a;break;case 1:t=r,n=l,r=a;break;case 2:t=a,n=l,r=o;break;case 3:t=a,n=r,r=l;break;case 4:t=o,n=a,r=l;break;case 5:t=l,n=a,r=r}return{R:t,G:n,B:r,A:e.A}}}(),void 0===eventjs)var eventjs={};if(function(e){"use strict";e.modifyEventListener=!1,e.modifySelectors=!1,e.add=function(e,t,r,i){return n(e,t,r,i,"add")},e.remove=function(e,t,r,i){return n(e,t,r,i,"remove")},e.returnFalse=function(e){return!1},e.stop=function(e){e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.cancelBubbleCount=0)},e.prevent=function(e){e&&(e.preventDefault?e.preventDefault():e.preventManipulation?e.preventManipulation():e.returnValue=!1)},e.cancel=function(t){e.stop(t),e.prevent(t)},e.blur=function(){var e=document.activeElement;if(e){var t=document.activeElement.nodeName;"INPUT"!==t&&"TEXTAREA"!==t&&"true"!==e.contentEditable||e.blur&&e.blur()}},e.getEventSupport=function(e,t){if("string"==typeof e&&(t=e,e=window),(t="on"+t)in e)return!0;if(e.setAttribute||(e=document.createElement("div")),e.setAttribute&&e.removeAttribute){e.setAttribute(t,"");var n="function"==typeof e[t];return void 0!==e[t]&&(e[t]=null),e.removeAttribute(t),n}};var t=function(e){if(!e||"object"!=typeof e)return e;var n=new e.constructor;for(var r in e)e[r]&&"object"==typeof e[r]?n[r]=t(e[r]):n[r]=e[r];return n},n=function(a,o,l,h,p,v){if(h=h||{},"[object Object]"===String(a)){var m=a;if(a=m.target,delete m.target,!m.type||!m.listener){for(var g in m){var y=m[g];"function"!=typeof y&&(h[g]=y)}var b={};for(var w in m){g=w.split(",");var A=m[w],x={};for(var M in h)x[M]=h[M];if("function"==typeof A)l=A;else{if("function"!=typeof A.listener)continue;l=A.listener;for(var M in A)"function"!=typeof A[M]&&(x[M]=A[M])}for(var k=0;k<g.length;k++)b[w]=eventjs.add(a,g[k],l,x,p)}return b}o=m.type,delete m.type,l=m.listener,delete m.listener;for(var w in m)h[w]=m[w]}if(a&&o&&l){if("string"==typeof a&&"ready"===o){if(!window.eventjs_stallOnReady){var _=(new Date).getTime(),q=h.timeout,S=h.interval||1e3/60,j=window.setInterval(function(){(new Date).getTime()-_>q&&window.clearInterval(j),document.querySelector(a)&&(window.clearInterval(j),setTimeout(l,1))},S);return}o="load",a=window}if("string"==typeof a){if(0===(a=document.querySelectorAll(a)).length)return i("Missing target on listener!",arguments);1===a.length&&(a=a[0])}var F,I={};if(a.length>0&&a!==window){for(var T=0,E=a.length;T<E;T++)(F=n(a[T],o,l,t(h),p))&&(I[T]=F);return r(I)}if("string"==typeof o&&(-1!==(o=o.toLowerCase()).indexOf(" ")?o=o.split(" "):-1!==o.indexOf(",")&&(o=o.split(","))),"string"!=typeof o){if("number"==typeof o.length)for(var C=0,G=o.length;C<G;C++)(F=n(a,o[C],l,t(h),p))&&(I[o[C]]=F);else for(var w in o)(F="function"==typeof o[w]?n(a,w,o[w],t(h),p):n(a,w,o[w].listener,t(o[w]),p))&&(I[w]=F);return r(I)}if(0===o.indexOf("on")&&(o=o.substr(2)),"object"!=typeof a)return i("Target is not defined!",arguments);if("function"!=typeof l)return i("Listener is not a function!",arguments);var B=h.useCapture||!1,D=c(a)+"."+c(l)+"."+(B?1:0);if(e.Gesture&&e.Gesture._gestureHandlers[o]){if(D=o+D,"remove"===p){if(!u[D])return;u[D].remove(),delete u[D]}else if("add"===p){if(u[D])return u[D].add(),u[D];if(h.useCall&&!e.modifyEventListener){var L=l;l=function(e,t){for(var n in t)e[n]=t[n];return L.call(a,e)}}h.gesture=o,h.target=a,h.listener=l,h.fromOverwrite=v,u[D]=e.proxy[o](h)}return u[D]}var P,R=s(o);for(k=0;k<R.length;k++)if(P=(o=R[k])+"."+D,"remove"===p){if(!u[P])continue;a[d](o,l,B),delete u[P]}else if("add"===p){if(u[P])return u[P];a[f](o,l,B),u[P]={id:P,type:o,target:a,listener:l,remove:function(){for(var t=0;t<R.length;t++)e.remove(a,R[t],l,h)}}}return u[P]}},r=function(e){return{remove:function(){for(var t in e)e[t].remove()},add:function(){for(var t in e)e[t].add()}}},i=function(e,t){"undefined"!=typeof console&&void 0!==console.error&&console.error(e,t)},a={msPointer:["MSPointerDown","MSPointerMove","MSPointerUp"],touch:["touchstart","touchmove","touchend"],mouse:["mousedown","mousemove","mouseup"]},o={MSPointerDown:0,MSPointerMove:1,MSPointerUp:2,touchstart:0,touchmove:1,touchend:2,mousedown:0,mousemove:1,mouseup:2},s=(e.supports={},window.navigator.msPointerEnabled&&(e.supports.msPointer=!0),e.getEventSupport("touchstart")&&(e.supports.touch=!0),e.getEventSupport("mousedown")&&(e.supports.mouse=!0),function(t){var n=document.addEventListener?"":"on",r=o[t];if(isFinite(r)){var i=[];for(var s in e.supports)i.push(n+a[s][r]);return i}return[n+t]}),u={},l=0,c=function(e){return e===window?"#window":e===document?"#document":(e.uniqueID||(e.uniqueID="e"+l++),e.uniqueID)},f=document.addEventListener?"addEventListener":"attachEvent",d=document.removeEventListener?"removeEventListener":"detachEvent";e.createPointerEvent=function(t,n,r){var i=n.gesture,a=n.target,o=t.changedTouches||e.proxy.getCoords(t);if(o.length){var s=o[0];n.pointers=r?[]:o,n.pageX=s.pageX,n.pageY=s.pageY,n.x=n.pageX,n.y=n.pageY}var u=document.createEvent("Event");u.initEvent(i,!0,!0),u.originalEvent=t;for(var l in n)"target"!==l&&(u[l]=n[l]);var c=u.type;e.Gesture&&e.Gesture._gestureHandlers[c]&&n.oldListener.call(a,u,n,!1)},e.modifyEventListener&&window.HTMLElement&&function(){var t=function(t){var r=function(r){var i=r+"EventListener",a=t[i];t[i]=function(t,i,o){if(e.Gesture&&e.Gesture._gestureHandlers[t]){var u=o;"object"==typeof o?u.useCall=!0:u={useCall:!0,useCapture:o},n(this,t,i,u,r,!0)}else for(var l=s(t),c=0;c<l.length;c++)a.call(this,l[c],i,o)}};r("add"),r("remove")};navigator.userAgent.match(/Firefox/)?(t(HTMLDivElement.prototype),t(HTMLCanvasElement.prototype)):t(HTMLElement.prototype),t(document),t(window)}(),e.modifySelectors&&function(){var e=NodeList.prototype;e.removeEventListener=function(e,t,n){for(var r=0,i=this.length;r<i;r++)this[r].removeEventListener(e,t,n)},e.addEventListener=function(e,t,n){for(var r=0,i=this.length;r<i;r++)this[r].addEventListener(e,t,n)}}()}(eventjs),void 0===eventjs)var eventjs={};if(void 0===eventjs.proxy&&(eventjs.proxy={}),eventjs.proxy=function(e){"use strict";e.pointerSetup=function(e,t){e.target=e.target||window,e.doc=e.target.ownerDocument||e.target,e.minFingers=e.minFingers||e.fingers||1,e.maxFingers=e.maxFingers||e.fingers||1/0,e.position=e.position||"relative",delete e.fingers,(t=t||{}).enabled=!0,t.gesture=e.gesture,t.target=e.target,t.env=e.env,eventjs.modifyEventListener&&e.fromOverwrite&&(e.oldListener=e.listener,e.listener=eventjs.createPointerEvent);var n=0,r=0===t.gesture.indexOf("pointer")&&eventjs.modifyEventListener?"pointer":"mouse";return e.oldListener&&(t.oldListener=e.oldListener),t.listener=e.listener,t.proxy=function(n){t.defaultListener=e.listener,e.listener=n,n(e.event,t)},t.add=function(){!0!==t.enabled&&(e.onPointerDown&&eventjs.add(e.target,r+"down",e.onPointerDown),e.onPointerMove&&eventjs.add(e.doc,r+"move",e.onPointerMove),e.onPointerUp&&eventjs.add(e.doc,r+"up",e.onPointerUp),t.enabled=!0)},t.remove=function(){!1!==t.enabled&&(e.onPointerDown&&eventjs.remove(e.target,r+"down",e.onPointerDown),e.onPointerMove&&eventjs.remove(e.doc,r+"move",e.onPointerMove),e.onPointerUp&&eventjs.remove(e.doc,r+"up",e.onPointerUp),t.reset(),t.enabled=!1)},t.pause=function(t){!e.onPointerMove||t&&!t.move||eventjs.remove(e.doc,r+"move",e.onPointerMove),!e.onPointerUp||t&&!t.up||eventjs.remove(e.doc,r+"up",e.onPointerUp),n=e.fingers,e.fingers=0},t.resume=function(t){!e.onPointerMove||t&&!t.move||eventjs.add(e.doc,r+"move",e.onPointerMove),!e.onPointerUp||t&&!t.up||eventjs.add(e.doc,r+"up",e.onPointerUp),e.fingers=n},t.reset=function(){e.tracker={},e.fingers=0},t};var t=eventjs.supports;eventjs.isMouse=!!t.mouse,eventjs.isMSPointer=!!t.touch,eventjs.isTouch=!!t.msPointer,e.pointerStart=function(t,n,r){var i=(t.type||"mousedown").toUpperCase();0===i.indexOf("MOUSE")?(eventjs.isMouse=!0,eventjs.isTouch=!1,eventjs.isMSPointer=!1):0===i.indexOf("TOUCH")?(eventjs.isMouse=!1,eventjs.isTouch=!0,eventjs.isMSPointer=!1):0===i.indexOf("MSPOINTER")&&(eventjs.isMouse=!1,eventjs.isTouch=!1,eventjs.isMSPointer=!0);var a=function(e,t){var n=r.bbox,i=s[t]={};switch(r.position){case"absolute":i.offsetX=0,i.offsetY=0;break;case"differenceFromLast":case"difference":i.offsetX=e.pageX,i.offsetY=e.pageY;break;case"move":i.offsetX=e.pageX-n.x1,i.offsetY=e.pageY-n.y1;break;default:i.offsetX=n.x1-n.scrollLeft,i.offsetY=n.y1-n.scrollTop}var a=e.pageX-i.offsetX,o=e.pageY-i.offsetY;i.rotation=0,i.scale=1,i.startTime=i.moveTime=(new Date).getTime(),i.move={x:a,y:o},i.start={x:a,y:o},r.fingers++};r.event=t,n.defaultListener&&(r.listener=n.defaultListener,delete n.defaultListener);for(var o=!r.fingers,s=r.tracker,u=t.changedTouches||e.getCoords(t),l=u.length,c=0;c<l;c++){var f=u[c],d=f.identifier||1/0;if(r.fingers){if(r.fingers>=r.maxFingers){var h=[];for(var d in r.tracker)h.push(d);return n.identifier=h.join(","),o}for(var p in s){if(s[p].up){delete s[p],a(f,d),r.cancel=!0;break}0}if(s[d])continue;a(f,d)}else s=r.tracker={},n.bbox=r.bbox=e.getBoundingBox(r.target),r.fingers=0,r.cancel=!1,a(f,d)}h=[];for(var d in r.tracker)h.push(d);return n.identifier=h.join(","),o},e.pointerEnd=function(e,t,n,r){for(var i=e.touches||[],a=i.length,o={},s=0;s<a;s++){o[(u=i[s].identifier)||1/0]=!0}for(var u in n.tracker){var l=n.tracker[u];o[u]||l.up||(r&&r({pageX:l.pageX,pageY:l.pageY,changedTouches:[{pageX:l.pageX,pageY:l.pageY,identifier:"Infinity"===u?1/0:u}]},"up"),l.up=!0,n.fingers--)}if(0!==n.fingers)return!1;var c=[];n.gestureFingers=0;for(var u in n.tracker)n.gestureFingers++,c.push(u);return t.identifier=c.join(","),!0},e.getCoords=function(t){return void 0!==t.pageX?e.getCoords=function(e){return Array({type:"mouse",x:e.pageX,y:e.pageY,pageX:e.pageX,pageY:e.pageY,identifier:e.pointerId||1/0})}:e.getCoords=function(e){var t=document.documentElement;return e=e||window.event,Array({type:"mouse",x:e.clientX+t.scrollLeft,y:e.clientY+t.scrollTop,pageX:e.clientX+t.scrollLeft,pageY:e.clientY+t.scrollTop,identifier:1/0})},e.getCoords(t)},e.getCoord=function(t){if("ontouchstart"in window){var n=0,r=0;e.getCoord=function(e){var t=e.changedTouches;return t&&t.length?{x:n=t[0].pageX,y:r=t[0].pageY}:{x:n,y:r}}}else void 0!==t.pageX&&void 0!==t.pageY?e.getCoord=function(e){return{x:e.pageX,y:e.pageY}}:e.getCoord=function(e){var t=document.documentElement;return{x:(e=e||window.event).clientX+t.scrollLeft,y:e.clientY+t.scrollTop}};return e.getCoord(t)};var n=function(e,t){var n=parseFloat(e.getPropertyValue(t),10);return isFinite(n)?n:0};return e.getBoundingBox=function(e){e!==window&&e!==document||(e=document.body);var t={},r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.x1=r.left,t.y1=r.top,t.scaleX=r.width/e.offsetWidth||1,t.scaleY=r.height/e.offsetHeight||1,t.scrollLeft=0,t.scrollTop=0;if(!1===("border-box"===(l=window.getComputedStyle(e)).getPropertyValue("box-sizing"))){var i=n(l,"border-left-width"),a=n(l,"border-right-width"),o=n(l,"border-bottom-width"),s=n(l,"border-top-width");t.border=[i,a,s,o],t.x1+=i,t.y1+=s,t.width-=a+i,t.height-=o+s}t.x2=t.x1+t.width,t.y2=t.y1+t.height;for(var u="fixed"===(c=l.getPropertyValue("position"))?e:e.parentNode;null!==u&&u!==document.body&&void 0!==u.scrollTop;){var l,c;if("absolute"===(c=(l=window.getComputedStyle(u)).getPropertyValue("position")));else{if("fixed"===c){t.scrollTop-=u.parentNode.scrollTop,t.scrollLeft-=u.parentNode.scrollLeft;break}t.scrollLeft+=u.scrollLeft,t.scrollTop+=u.scrollTop}u=u.parentNode}return t.scrollBodyLeft=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t.scrollBodyTop=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,t.scrollLeft-=t.scrollBodyLeft,t.scrollTop-=t.scrollBodyTop,t},function(){var t,n=navigator.userAgent.toLowerCase(),r=-1!==n.indexOf("macintosh");t=r&&-1!==n.indexOf("khtml")?{91:!0,93:!0}:r&&-1!==n.indexOf("firefox")?{224:!0}:{17:!0},(e.metaTrackerReset=function(){eventjs.fnKey=e.fnKey=!1,eventjs.metaKey=e.metaKey=!1,eventjs.ctrlKey=e.ctrlKey=!1,eventjs.shiftKey=e.shiftKey=!1,eventjs.altKey=e.altKey=!1})(),e.metaTracker=function(n){var r=!!t[n.keyCode];return r&&(eventjs.metaKey=e.metaKey="keydown"===n.type),eventjs.ctrlKey=e.ctrlKey=n.ctrlKey,eventjs.shiftKey=e.shiftKey=n.shiftKey,eventjs.altKey=e.altKey=n.altKey,r}}(),e}(eventjs.proxy),void 0===eventjs)var eventjs={};if(eventjs.MutationObserver=function(){var e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,t=!e&&function(){var e=document.createElement("p"),t=!1,n=function(){t=!0};if(e.addEventListener)e.addEventListener("DOMAttrModified",n,!1);else{if(!e.attachEvent)return!1;e.attachEvent("onDOMAttrModified",n)}return e.setAttribute("id","target"),t}();return function(n,r){if(e){var i={subtree:!1,attributes:!0};new e(function(e){e.forEach(function(e){r.call(e.target,e.attributeName)})}).observe(n,i)}else t?eventjs.add(n,"DOMAttrModified",function(e){r.call(n,e.attrName)}):"onpropertychange"in document.body&&eventjs.add(n,"propertychange",function(e){r.call(n,window.event.propertyName)})}}(),void 0===eventjs)var eventjs={};if(void 0===eventjs.proxy&&(eventjs.proxy={}),eventjs.proxy=function(e){"use strict";return e.click=function(t){t.gesture=t.gesture||"click",t.maxFingers=t.maxFingers||t.fingers||1,t.onPointerDown=function(r){e.pointerStart(r,n,t)&&eventjs.add(t.target,"mouseup",t.onPointerUp)},t.onPointerUp=function(r){if(e.pointerEnd(r,n,t)){eventjs.remove(t.target,"mouseup",t.onPointerUp);var i=(r.changedTouches||e.getCoords(r))[0],a=t.bbox,o=e.getBoundingBox(t.target),s=i.pageY-o.scrollBodyTop,u=i.pageX-o.scrollBodyLeft;if(u>a.x1&&s>a.y1&&u<a.x2&&s<a.y2&&a.scrollTop===o.scrollTop){for(var l in t.tracker)break;var c=t.tracker[l];n.x=c.start.x,n.y=c.start.y,t.listener(r,n)}}};var n=e.pointerSetup(t);return n.state="click",eventjs.add(t.target,"mousedown",t.onPointerDown),n},eventjs.Gesture=eventjs.Gesture||{},eventjs.Gesture._gestureHandlers=eventjs.Gesture._gestureHandlers||{},eventjs.Gesture._gestureHandlers.click=e.click,e}(eventjs.proxy),void 0===eventjs)var eventjs={};if(void 0===eventjs.proxy&&(eventjs.proxy={}),eventjs.proxy=function(e){"use strict";return e.dbltap=e.dblclick=function(t){t.gesture=t.gesture||"dbltap",t.maxFingers=t.maxFingers||t.fingers||1;var n,r,i,a,o;t.onPointerDown=function(u){var l=u.changedTouches||e.getCoords(u);n&&!r?(o=l[0],r=(new Date).getTime()-n):(a=l[0],n=(new Date).getTime(),r=0,clearTimeout(i),i=setTimeout(function(){n=0},700)),e.pointerStart(u,s,t)&&(eventjs.add(t.target,"mousemove",t.onPointerMove).listener(u),eventjs.add(t.target,"mouseup",t.onPointerUp))},t.onPointerMove=function(s){if(n&&!r){var u=s.changedTouches||e.getCoords(s);o=u[0]}var l=t.bbox,c=o.pageX-l.x1,f=o.pageY-l.y1;c>0&&c<l.width&&f>0&&f<l.height&&Math.abs(o.pageX-a.pageX)<=25&&Math.abs(o.pageY-a.pageY)<=25||(eventjs.remove(t.target,"mousemove",t.onPointerMove),clearTimeout(i),n=r=0)},t.onPointerUp=function(a){if(e.pointerEnd(a,s,t)&&(eventjs.remove(t.target,"mousemove",t.onPointerMove),eventjs.remove(t.target,"mouseup",t.onPointerUp)),n&&r){if(r<=700){s.state=t.gesture;for(var o in t.tracker)break;var u=t.tracker[o];s.x=u.start.x,s.y=u.start.y,t.listener(a,s)}clearTimeout(i),n=r=0}};var s=e.pointerSetup(t);return s.state="dblclick",eventjs.add(t.target,"mousedown",t.onPointerDown),s},eventjs.Gesture=eventjs.Gesture||{},eventjs.Gesture._gestureHandlers=eventjs.Gesture._gestureHandlers||{},eventjs.Gesture._gestureHandlers.dbltap=e.dbltap,eventjs.Gesture._gestureHandlers.dblclick=e.dblclick,e}(eventjs.proxy),void 0===eventjs)var eventjs={};if(void 0===eventjs.proxy&&(eventjs.proxy={}),eventjs.proxy=function(e){"use strict";return e.dragElement=function(t,n){e.drag({event:n,target:t,position:"move",listener:function(e,n){t.style.left=n.x+"px",t.style.top=n.y+"px",eventjs.prevent(e)}})},e.drag=function(t){t.gesture="drag",t.onPointerDown=function(r){e.pointerStart(r,n,t)&&(t.monitor||(eventjs.add(t.doc,"mousemove",t.onPointerMove),eventjs.add(t.doc,"mouseup",t.onPointerUp))),t.onPointerMove(r,"down")},t.onPointerMove=function(r,i){if(!t.tracker)return t.onPointerDown(r);t.bbox;for(var a=r.changedTouches||e.getCoords(r),o=a.length,s=0;s<o;s++){var u=a[s],l=u.identifier||1/0,c=t.tracker[l];c&&(c.pageX=u.pageX,c.pageY=u.pageY,n.state=i||"move",n.identifier=l,n.start=c.start,n.fingers=t.fingers,"differenceFromLast"===t.position?(n.x=c.pageX-c.offsetX,n.y=c.pageY-c.offsetY,c.offsetX=c.pageX,c.offsetY=c.pageY):(n.x=c.pageX-c.offsetX,n.y=c.pageY-c.offsetY),t.listener(r,n))}},t.onPointerUp=function(r){e.pointerEnd(r,n,t,t.onPointerMove)&&(t.monitor||(eventjs.remove(t.doc,"mousemove",t.onPointerMove),eventjs.remove(t.doc,"mouseup",t.onPointerUp)))};var n=e.pointerSetup(t);return t.event?t.onPointerDown(t.event):(eventjs.add(t.target,"mousedown",t.onPointerDown),t.monitor&&(eventjs.add(t.doc,"mousemove",t.onPointerMove),eventjs.add(t.doc,"mouseup",t.onPointerUp))),n},eventjs.Gesture=eventjs.Gesture||{},eventjs.Gesture._gestureHandlers=eventjs.Gesture._gestureHandlers||{},eventjs.Gesture._gestureHandlers.drag=e.drag,e}(eventjs.proxy),void 0===eventjs)var eventjs={};if(void 0===eventjs.proxy&&(eventjs.proxy={}),eventjs.proxy=function(e){"use strict";var t=Math.PI/180,n=function(e,t){var n=0,r=0,i=0;for(var a in t){var o=t[a];o.up||(n+=o.move.x,r+=o.move.y,i++)}return e.x=n/=i,e.y=r/=i,e};return e.gesture=function(r){r.gesture=r.gesture||"gesture",r.minFingers=r.minFingers||r.fingers||2,r.onPointerDown=function(t){var a=r.fingers;if(e.pointerStart(t,i,r)&&(eventjs.add(r.doc,"mousemove",r.onPointerMove),eventjs.add(r.doc,"mouseup",r.onPointerUp)),r.fingers===r.minFingers&&a!==r.fingers){i.fingers=r.minFingers,i.scale=1,i.rotation=0,i.state="start";var o="";for(var s in r.tracker)o+=s;i.identifier=parseInt(o),n(i,r.tracker),r.listener(t,i)}},r.onPointerMove=function(a,o){for(var s=r.bbox,u=r.tracker,l=(d=a.changedTouches||e.getCoords(a)).length,c=0;c<l;c++){var f=u[v=(m=d[c]).identifier||1/0];f&&(f.move.x=m.pageX-s.x1,f.move.y=m.pageY-s.y1)}if(!(r.fingers<r.minFingers)){var d=[],h=0,p=0;n(i,u);for(var v in u){var m;if(!(m=u[v]).up){var g=m.start;if(!g.distance){var y=g.x-i.x,b=g.y-i.y;g.distance=Math.sqrt(y*y+b*b),g.angle=Math.atan2(y,b)/t}y=m.move.x-i.x,b=m.move.y-i.y;h+=Math.sqrt(y*y+b*b)/g.distance;var w=Math.atan2(y,b)/t,A=(g.angle-w+360)%360-180;m.DEG2=m.DEG1,m.DEG1=A>0?A:-A,void 0!==m.DEG2&&(A>0?m.rotation+=m.DEG1-m.DEG2:m.rotation-=m.DEG1-m.DEG2,p+=m.rotation),d.push(m.move)}}i.touches=d,i.fingers=r.fingers,i.scale=h/r.fingers,i.rotation=p/r.fingers,i.state="change",r.listener(a,i)}},r.onPointerUp=function(t){var n=r.fingers;e.pointerEnd(t,i,r)&&(eventjs.remove(r.doc,"mousemove",r.onPointerMove),eventjs.remove(r.doc,"mouseup",r.onPointerUp)),n===r.minFingers&&r.fingers<r.minFingers&&(i.fingers=r.fingers,i.state="end",r.listener(t,i))};var i=e.pointerSetup(r);return eventjs.add(r.target,"mousedown",r.onPointerDown),i},eventjs.Gesture=eventjs.Gesture||{},eventjs.Gesture._gestureHandlers=eventjs.Gesture._gestureHandlers||{},eventjs.Gesture._gestureHandlers.gesture=e.gesture,e}(eventjs.proxy),void 0===eventjs)var eventjs={};if(void 0===eventjs.proxy&&(eventjs.proxy={}),eventjs.proxy=function(e){"use strict";return e.pointerdown=e.pointermove=e.pointerup=function(t){if(t.gesture=t.gesture||"pointer",!t.target.isPointerEmitter){var n=!0;t.onPointerDown=function(e){n=!1,r.gesture="pointerdown",t.listener(e,r)},t.onPointerMove=function(e){r.gesture="pointermove",t.listener(e,r,n)},t.onPointerUp=function(e){n=!0,r.gesture="pointerup",t.listener(e,r,!0)};var r=e.pointerSetup(t);return eventjs.add(t.target,"mousedown",t.onPointerDown),eventjs.add(t.target,"mousemove",t.onPointerMove),eventjs.add(t.doc,"mouseup",t.onPointerUp),t.target.isPointerEmitter=!0,r}},eventjs.Gesture=eventjs.Gesture||{},eventjs.Gesture._gestureHandlers=eventjs.Gesture._gestureHandlers||{},eventjs.Gesture._gestureHandlers.pointerdown=e.pointerdown,eventjs.Gesture._gestureHandlers.pointermove=e.pointermove,eventjs.Gesture._gestureHandlers.pointerup=e.pointerup,e}(eventjs.proxy),void 0===eventjs)var eventjs={};if(void 0===eventjs.proxy&&(eventjs.proxy={}),eventjs.proxy=function(e){"use strict";return e.shake=function(e){var t={gesture:"devicemotion",acceleration:{},accelerationIncludingGravity:{},target:e.target,listener:e.listener,remove:function(){window.removeEventListener("devicemotion",a,!1)}},n=(new Date).getTime(),r={x:0,y:0,z:0},i={x:{count:0,value:0},y:{count:0,value:0},z:{count:0,value:0}},a=function(a){var o=a.accelerationIncludingGravity;if(r.x=.8*r.x+(1-.8)*o.x,r.y=.8*r.y+(1-.8)*o.y,r.z=.8*r.z+(1-.8)*o.z,t.accelerationIncludingGravity=r,t.acceleration.x=o.x-r.x,t.acceleration.y=o.y-r.y,t.acceleration.z=o.z-r.z,"devicemotion"!==e.gesture)for(var s=(new Date).getTime(),u=0,l="xyz".length;u<l;u++){var c="xyz"[u],f=t.acceleration[c],d=i[c],h=Math.abs(f);if(!(s-n<1e3)&&h>4){var p=s*f/h,v=Math.abs(p+d.value);d.value&&v<200?(d.value=p,d.count++,3===d.count&&(e.listener(a,t),n=s,d.value=0,d.count=0)):(d.value=p,d.count=1)}}else e.listener(a,t)};if(window.addEventListener)return window.addEventListener("devicemotion",a,!1),t},eventjs.Gesture=eventjs.Gesture||{},eventjs.Gesture._gestureHandlers=eventjs.Gesture._gestureHandlers||{},eventjs.Gesture._gestureHandlers.shake=e.shake,e}(eventjs.proxy),void 0===eventjs)var eventjs={};if(void 0===eventjs.proxy&&(eventjs.proxy={}),eventjs.proxy=function(e){"use strict";var t=Math.PI/180;return e.swipe=function(n){n.snap=n.snap||90,n.threshold=n.threshold||1,n.gesture=n.gesture||"swipe",n.onPointerDown=function(t){e.pointerStart(t,r,n)&&(eventjs.add(n.doc,"mousemove",n.onPointerMove).listener(t),eventjs.add(n.doc,"mouseup",n.onPointerUp))},n.onPointerMove=function(t){for(var r=t.changedTouches||e.getCoords(t),i=r.length,a=0;a<i;a++){var o=r[a],s=o.identifier||1/0,u=n.tracker[s];u&&(u.move.x=o.pageX,u.move.y=o.pageY,u.moveTime=(new Date).getTime())}},n.onPointerUp=function(i){if(e.pointerEnd(i,r,n)){eventjs.remove(n.doc,"mousemove",n.onPointerMove),eventjs.remove(n.doc,"mouseup",n.onPointerUp);var a,o,s={x:0,y:0},u=0,l=0,c=0;for(var f in n.tracker){var d=n.tracker[f],h=d.move.x-d.start.x,p=d.move.y-d.start.y;u+=d.move.x,l+=d.move.y,s.x+=d.start.x,s.y+=d.start.y,c++;var v=Math.sqrt(h*h+p*p),m=d.moveTime-d.startTime,g=Math.atan2(h,p)/t+180,y=m?v/m:0;if(void 0===o)o=g,a=y;else{if(!(Math.abs(g-o)<=20))return;o=(o+g)/2,a=(a+y)/2}}var b=n.gestureFingers;n.minFingers<=b&&n.maxFingers>=b&&a>n.threshold&&(s.x/=c,s.y/=c,r.start=s,r.x=u/c,r.y=l/c,r.angle=-(((o/n.snap+.5>>0)*n.snap||360)-360),r.velocity=a,r.fingers=b,r.state="swipe",n.listener(i,r))}};var r=e.pointerSetup(n);return eventjs.add(n.target,"mousedown",n.onPointerDown),r},eventjs.Gesture=eventjs.Gesture||{},eventjs.Gesture._gestureHandlers=eventjs.Gesture._gestureHandlers||{},eventjs.Gesture._gestureHandlers.swipe=e.swipe,e}(eventjs.proxy),void 0===eventjs)var eventjs={};if(void 0===eventjs.proxy&&(eventjs.proxy={}),eventjs.proxy=function(e){"use strict";return e.longpress=function(t){return t.gesture="longpress",e.tap(t)},e.tap=function(t){t.delay=t.delay||500,t.timeout=t.timeout||250,t.driftDeviance=t.driftDeviance||10,t.gesture=t.gesture||"tap";var n,r;t.onPointerDown=function(a){if(e.pointerStart(a,i,t)){if(n=(new Date).getTime(),eventjs.add(t.doc,"mousemove",t.onPointerMove).listener(a),eventjs.add(t.doc,"mouseup",t.onPointerUp),"longpress"!==t.gesture)return;r=setTimeout(function(){if(!(a.cancelBubble&&++a.cancelBubbleCount>1)){var e=0;for(var n in t.tracker){var r=t.tracker[n];if(!0===r.end)return;if(t.cancel)return;e++}t.minFingers<=e&&t.maxFingers>=e&&(i.state="start",i.fingers=e,i.x=r.start.x,i.y=r.start.y,t.listener(a,i))}},t.delay)}},t.onPointerMove=function(n){for(var r=t.bbox,i=n.changedTouches||e.getCoords(n),a=i.length,o=0;o<a;o++){var s=i[o],u=s.identifier||1/0,l=t.tracker[u];if(l){var c=s.pageX-r.x1,f=s.pageY-r.y1,d=c-l.start.x,h=f-l.start.y,p=Math.sqrt(d*d+h*h);if(!(c>0&&c<r.width&&f>0&&f<r.height&&p<=t.driftDeviance))return eventjs.remove(t.doc,"mousemove",t.onPointerMove),void(t.cancel=!0)}}},t.onPointerUp=function(a){if(e.pointerEnd(a,i,t)){if(clearTimeout(r),eventjs.remove(t.doc,"mousemove",t.onPointerMove),eventjs.remove(t.doc,"mouseup",t.onPointerUp),a.cancelBubble&&++a.cancelBubbleCount>1)return;if("longpress"===t.gesture)return void("start"===i.state&&(i.state="end",t.listener(a,i)));if(t.cancel)return;if((new Date).getTime()-n>t.timeout)return;var o=t.gestureFingers;t.minFingers<=o&&t.maxFingers>=o&&(i.state="tap",i.fingers=t.gestureFingers,t.listener(a,i))}};var i=e.pointerSetup(t);return eventjs.add(t.target,"mousedown",t.onPointerDown),i},eventjs.Gesture=eventjs.Gesture||{},eventjs.Gesture._gestureHandlers=eventjs.Gesture._gestureHandlers||{},eventjs.Gesture._gestureHandlers.tap=e.tap,eventjs.Gesture._gestureHandlers.longpress=e.longpress,e}(eventjs.proxy),void 0===eventjs)var eventjs={};void 0===eventjs.proxy&&(eventjs.proxy={}),eventjs.proxy=function(e){"use strict";return e.wheelPreventElasticBounce=function(e){e&&("string"==typeof e&&(e=document.querySelector(e)),eventjs.add(e,"wheel",function(e,t){t.preventElasticBounce(),eventjs.stop(e)}))},e.wheel=function(e){var t,n=e.timeout||150,r=0,i={gesture:"wheel",state:"start",wheelDelta:0,target:e.target,listener:e.listener,preventElasticBounce:function(e){var t=this.target,n=t.scrollTop;n+t.offsetHeight===t.scrollHeight&&this.wheelDelta<=0?eventjs.cancel(e):0===n&&this.wheelDelta>=0&&eventjs.cancel(e),eventjs.stop(e)},add:function(){e.target[o](u,a,!1)},remove:function(){e.target[s](u,a,!1)}},a=function(a){a=a||window.event,i.state=r++?"change":"start",i.wheelDelta=a.detail?-20*a.detail:a.wheelDelta,e.listener(a,i),clearTimeout(t),t=setTimeout(function(){r=0,i.state="end",i.wheelDelta=0,e.listener(a,i)},n)},o=document.addEventListener?"addEventListener":"attachEvent",s=document.removeEventListener?"removeEventListener":"detachEvent",u=eventjs.getEventSupport("mousewheel")?"mousewheel":"DOMMouseScroll";return e.target[o](u,a,!1),i},eventjs.Gesture=eventjs.Gesture||{},eventjs.Gesture._gestureHandlers=eventjs.Gesture._gestureHandlers||{},eventjs.Gesture._gestureHandlers.wheel=e.wheel,e}(eventjs.proxy);var addEvent=eventjs.add,removeEvent=eventjs.remove;if(function(){for(var e in eventjs)Event[e]=eventjs[e];for(var e in eventjs.proxy)addEvent[e]=eventjs.proxy[e]}(),"undefined"==typeof sketch&&(sketch={}),function(e){"use strict";e.ui=e.ui||{},e.ui.Timer=function(e){e=e||{};var n,r,i,a,o,s,u=this,l=1/(180/Math.PI),c=function(e){n=e.size||120,r=e.format||"percent",i=e.container||document.body,a=e.endValue,o=e.value||0},f=["#9cdb7d","#99d97f","#97d782","#95d684","#93d487","#91d38a","#8fd18c","#8dcf8f","#8bce91","#89cc94","#87cb97","#85c999","#83c89c","#81c69e","#7fc4a1","#7dc3a4","#7bc1a6","#79c0a9","#77beab","#75bcae","#73bbb1","#71b9b3","#6fb8b6","#6db6b8","#6bb5bb","#69b3be","#67b1c0","#65b0c3","#63aec5","#61adc8","#5fabcb","#5daacd","#5ba8d0","#59a6d2","#57a5d5","#55a3d8","#53a2da","#51a0dd","#4f9edf","#4d9de2","#4b9be5","#499ae7","#4798ea","#4597ec","#4395ef","#4193f2","#3f92f4","#3d90f7","#3b8ff9","#398dfc","#378cff"],d=Date.now(),h=function(){var e=function(){if("percent"===r)return{value:o,format:"PERCENT",percent:o/100};if("time"===r){var e=(Date.now()-d)/1e3,t=a-e,n=e/a,i=Math.max(0,Math.round(t)),s=i/3600>>0,u=(i-3600*s)/60>>0,l=i-3600*s-60*u;return l<10&&u&&(l="0"+l),u?{value:u,format:"MINUTES",percent:n}:{value:l,format:"SECONDS",percent:n}}}();v.fillStyle=f[Math.round(50*(1-e.percent))];var t=-360*l,i=360*e.percent*l,u=n/2+0,c=n/2*.61+0;v.clearRect(0,0,p.width,p.height),v.save(),v.beginPath(),v.arc(u,u,u,t,i,!1),v.arc(u,u,c,i,t,!0),v.globalAlpha=.25,v.fill(),t+=360*l,v.beginPath(),v.arc(u,u,u,t,i,!1),v.arc(u,u,c,i,t,!0),v.globalAlpha=1,v.fill();var m=n/260,g=26*m,y='"Trebuchet MS", Arial, Helvetica, sans-serif';v.font="bold "+g+"px "+y,v.textBaseline="top",v.textAlign="center",v.fillText(e.format,u,u+14*m);g=46*m;v.font="bold "+g+"px "+y,v.fillStyle="#ffffff",v.fillText(e.value,u,u-44*m),v.restore(),e.percent<1&&(s=requestAnimationFrame(h))};c(e);var p=document.createElement("canvas"),v=p.getContext("2d");p.width=n,p.height=n;var m=document.createElement("div");return m.style.display="none",m.className="sk-timer",m.appendChild(p),i.appendChild(m),e.onstart&&setTimeout(e.onstart,250),u.reset=function(){c(e)},u.destroy=function(){i.removeChild(p)},u.hidden=!1,u.hide=function(e){cancelAnimationFrame(s),u.hidden=!0,m.style.transition="opacity .35s",m.style.opacity=0,setTimeout(function(){m.style.display="none",e&&e()},350)},u.setValue=function(e){cancelAnimationFrame(s),u.hidden=!1,m.style.display="block",m.style.opacity=1,(o=Math.ceil(e))>=100&&u.hide(),h()},t(),u};var t=function(){if(null==document.getElementById("sk-timer-stylesheet")){var e=document.createElement("style");e.id="sk-timer-stylesheet",e.innerHTML=".sk-timer {\t\t\t\tposition: absolute;\t\t\t\tz-index: 1000;\t\t\t\ttop: 0;\t\t\t\tleft: 0;\t\t\t\twidth: 100%;\t\t\t\theight: 100%;\t\t\t}\t\t\t.sk-timer canvas {\t\t\t\tborder: 3px solid #000;\t\t\t\tborder-radius: 50%;\t\t\t\tbackground: #000;\t\t\t\tmargin: auto;\t\t\t\tposition: absolute;\t\t\t\ttop: 0;\t\t\t\tleft: 0;\t\t\t\tright: 0;\t\t\t\tbottom: 0;\t\t\t}\t\t",document.head.appendChild(e)}}}(sketch),void 0===MIDI&&(MIDI={}),function(e){"use strict";var t={},n=0,r=function(e){n++;var r=document.body,i=new Audio,a=e.split(";")[0];i.id="audio",i.setAttribute("preload","auto"),i.setAttribute("audiobuffer",!0),i.addEventListener("error",function(){r.removeChild(i),t[a]=!1,n--},!1),i.addEventListener("canplaythrough",function(){r.removeChild(i),t[a]=!0,n--},!1),i.src="data:"+e,r.appendChild(i)};MIDI.audioDetect=function(e){if(navigator.requestMIDIAccess){if(Function.prototype.toString.call(navigator.requestMIDIAccess).indexOf("[native code]"))t.webmidi=!0;else for(var i=0;navigator.plugins.length>i;i++){navigator.plugins[i].name.indexOf("Jazz-Plugin")>=0&&(t.webmidi=!0)}}if("undefined"==typeof Audio)return e({});t.audiotag=!0,(window.AudioContext||window.webkitAudioContext)&&(t.webaudio=!0);var a=new Audio;if(void 0===a.canPlayType)return e(t);var o=a.canPlayType('audio/ogg; codecs="vorbis"');o="probably"===o||"maybe"===o;var s=a.canPlayType("audio/mpeg");if(s="probably"===s||"maybe"===s,o||s){o&&r("audio/ogg;base64,T2dnUwACAAAAAAAAAADqnjMlAAAAAOyyzPIBHgF2b3JiaXMAAAAAAUAfAABAHwAAQB8AAEAfAACZAU9nZ1MAAAAAAAAAAAAA6p4zJQEAAAANJGeqCj3//////////5ADdm9yYmlzLQAAAFhpcGguT3JnIGxpYlZvcmJpcyBJIDIwMTAxMTAxIChTY2hhdWZlbnVnZ2V0KQAAAAABBXZvcmJpcw9CQ1YBAAABAAxSFCElGVNKYwiVUlIpBR1jUFtHHWPUOUYhZBBTiEkZpXtPKpVYSsgRUlgpRR1TTFNJlVKWKUUdYxRTSCFT1jFloXMUS4ZJCSVsTa50FkvomWOWMUYdY85aSp1j1jFFHWNSUkmhcxg6ZiVkFDpGxehifDA6laJCKL7H3lLpLYWKW4q91xpT6y2EGEtpwQhhc+211dxKasUYY4wxxsXiUyiC0JBVAAABAABABAFCQ1YBAAoAAMJQDEVRgNCQVQBABgCAABRFcRTHcRxHkiTLAkJDVgEAQAAAAgAAKI7hKJIjSZJkWZZlWZameZaouaov+64u667t6roOhIasBACAAAAYRqF1TCqDEEPKQ4QUY9AzoxBDDEzGHGNONKQMMogzxZAyiFssLqgQBKEhKwKAKAAAwBjEGGIMOeekZFIi55iUTkoDnaPUUcoolRRLjBmlEluJMYLOUeooZZRCjKXFjFKJscRUAABAgAMAQICFUGjIigAgCgCAMAYphZRCjCnmFHOIMeUcgwwxxiBkzinoGJNOSuWck85JiRhjzjEHlXNOSuekctBJyaQTAAAQ4AAAEGAhFBqyIgCIEwAwSJKmWZomipamiaJniqrqiaKqWp5nmp5pqqpnmqpqqqrrmqrqypbnmaZnmqrqmaaqiqbquqaquq6nqrZsuqoum65q267s+rZru77uqapsm6or66bqyrrqyrbuurbtS56nqqKquq5nqq6ruq5uq65r25pqyq6purJtuq4tu7Js664s67pmqq5suqotm64s667s2rYqy7ovuq5uq7Ks+6os+75s67ru2rrwi65r66os674qy74x27bwy7ouHJMnqqqnqq7rmarrqq5r26rr2rqmmq5suq4tm6or26os67Yry7aumaosm64r26bryrIqy77vyrJui67r66Ys67oqy8Lu6roxzLat+6Lr6roqy7qvyrKuu7ru+7JuC7umqrpuyrKvm7Ks+7auC8us27oxuq7vq7It/KosC7+u+8Iy6z5jdF1fV21ZGFbZ9n3d95Vj1nVhWW1b+V1bZ7y+bgy7bvzKrQvLstq2scy6rSyvrxvDLux8W/iVmqratum6um7Ksq/Lui60dd1XRtf1fdW2fV+VZd+3hV9pG8OwjK6r+6os68Jry8ov67qw7MIvLKttK7+r68ow27qw3L6wLL/uC8uq277v6rrStXVluX2fsSu38QsAABhwAAAIMKEMFBqyIgCIEwBAEHIOKQahYgpCCKGkEEIqFWNSMuakZM5JKaWUFEpJrWJMSuaclMwxKaGUlkopqYRSWiqlxBRKaS2l1mJKqcVQSmulpNZKSa2llGJMrcUYMSYlc05K5pyUklJrJZXWMucoZQ5K6iCklEoqraTUYuacpA46Kx2E1EoqMZWUYgupxFZKaq2kFGMrMdXUWo4hpRhLSrGVlFptMdXWWqs1YkxK5pyUzDkqJaXWSiqtZc5J6iC01DkoqaTUYiopxco5SR2ElDLIqJSUWiupxBJSia20FGMpqcXUYq4pxRZDSS2WlFosqcTWYoy1tVRTJ6XFklKMJZUYW6y5ttZqDKXEVkqLsaSUW2sx1xZjjqGkFksrsZWUWmy15dhayzW1VGNKrdYWY40x5ZRrrT2n1mJNMdXaWqy51ZZbzLXnTkprpZQWS0oxttZijTHmHEppraQUWykpxtZara3FXEMpsZXSWiypxNhirLXFVmNqrcYWW62ltVprrb3GVlsurdXcYqw9tZRrrLXmWFNtBQAADDgAAASYUAYKDVkJAEQBAADGMMYYhEYpx5yT0ijlnHNSKucghJBS5hyEEFLKnINQSkuZcxBKSSmUklJqrYVSUmqttQIAAAocAAACbNCUWByg0JCVAEAqAIDBcTRNFFXVdX1fsSxRVFXXlW3jVyxNFFVVdm1b+DVRVFXXtW3bFn5NFFVVdmXZtoWiqrqybduybgvDqKqua9uybeuorqvbuq3bui9UXVmWbVu3dR3XtnXd9nVd+Bmzbeu2buu+8CMMR9/4IeTj+3RCCAAAT3AAACqwYXWEk6KxwEJDVgIAGQAAgDFKGYUYM0gxphhjTDHGmAAAgAEHAIAAE8pAoSErAoAoAADAOeecc84555xzzjnnnHPOOeecc44xxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY0wAwE6EA8BOhIVQaMhKACAcAABACCEpKaWUUkoRU85BSSmllFKqFIOMSkoppZRSpBR1lFJKKaWUIqWgpJJSSimllElJKaWUUkoppYw6SimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaVUSimllFJKKaWUUkoppRQAYPLgAACVYOMMK0lnhaPBhYasBAByAwAAhRiDEEJpraRUUkolVc5BKCWUlEpKKZWUUqqYgxBKKqmlklJKKbXSQSihlFBKKSWUUkooJYQQSgmhlFRCK6mEUkoHoYQSQimhhFRKKSWUzkEoIYUOQkmllNRCSB10VFIpIZVSSiklpZQ6CKGUklJLLZVSWkqpdBJSKamV1FJqqbWSUgmhpFZKSSWl0lpJJbUSSkklpZRSSymFVFJJJYSSUioltZZaSqm11lJIqZWUUkqppdRSSiWlkEpKqZSSUmollZRSaiGVlEpJKaTUSimlpFRCSamlUlpKLbWUSkmptFRSSaWUlEpJKaVSSksppRJKSqmllFpJKYWSUkoplZJSSyW1VEoKJaWUUkmptJRSSymVklIBAEAHDgAAAUZUWoidZlx5BI4oZJiAAgAAQABAgAkgMEBQMApBgDACAQAAAADAAAAfAABHARAR0ZzBAUKCwgJDg8MDAAAAAAAAAAAAAACAT2dnUwAEAAAAAAAAAADqnjMlAgAAADzQPmcBAQA="),s&&r("audio/mpeg;base64,/+MYxAAAAANIAUAAAASEEB/jwOFM/0MM/90b/+RhST//w4NFwOjf///PZu////9lns5GFDv//l9GlUIEEIAAAgIg8Ir/JGq3/+MYxDsLIj5QMYcoAP0dv9HIjUcH//yYSg+CIbkGP//8w0bLVjUP///3Z0x5QCAv/yLjwtGKTEFNRTMuOTeqqqqqqqqqqqqq/+MYxEkNmdJkUYc4AKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq");var u=(new Date).getTime(),l=window.setInterval(function(){var r=(new Date).getTime();n&&!(r-u>5e3)||(window.clearInterval(l),e(t))},1)}else e(t)}}(),function(e){"use strict";e.GM=function(e){var t=function(e){return e.replace(/[^a-z0-9 ]/gi,"").replace(/[ ]/g,"_").toLowerCase()},n={byName:{},byId:{},byCategory:{}};for(var r in e)for(var i=e[r],a=0,o=i.length;a<o;a++){var s=i[a];if(s){var u=parseInt(s.substr(0,s.indexOf(" ")),10);s=s.replace(u+" ",""),n.byId[--u]=n.byName[t(s)]=n.byCategory[t(r)]={id:t(s),instrument:s,number:u,category:r}}}return n}({Piano:["1 Acoustic Grand Piano","2 Bright Acoustic Piano","3 Electric Grand Piano","4 Honky-tonk Piano","5 Electric Piano 1","6 Electric Piano 2","7 Harpsichord","8 Clavinet"],"Chromatic Percussion":["9 Celesta","10 Glockenspiel","11 Music Box","12 Vibraphone","13 Marimba","14 Xylophone","15 Tubular Bells","16 Dulcimer"],Organ:["17 Drawbar Organ","18 Percussive Organ","19 Rock Organ","20 Church Organ","21 Reed Organ","22 Accordion","23 Harmonica","24 Tango Accordion"],Guitar:["25 Acoustic Guitar (nylon)","26 Acoustic Guitar (steel)","27 Electric Guitar (jazz)","28 Electric Guitar (clean)","29 Electric Guitar (muted)","30 Overdriven Guitar","31 Distortion Guitar","32 Guitar Harmonics"],Bass:["33 Acoustic Bass","34 Electric Bass (finger)","35 Electric Bass (pick)","36 Fretless Bass","37 Slap Bass 1","38 Slap Bass 2","39 Synth Bass 1","40 Synth Bass 2"],Strings:["41 Violin","42 Viola","43 Cello","44 Contrabass","45 Tremolo Strings","46 Pizzicato Strings","47 Orchestral Harp","48 Timpani"],Ensemble:["49 String Ensemble 1","50 String Ensemble 2","51 Synth Strings 1","52 Synth Strings 2","53 Choir Aahs","54 Voice Oohs","55 Synth Choir","56 Orchestra Hit"],Brass:["57 Trumpet","58 Trombone","59 Tuba","60 Muted Trumpet","61 French Horn","62 Brass Section","63 Synth Brass 1","64 Synth Brass 2"],Reed:["65 Soprano Sax","66 Alto Sax","67 Tenor Sax","68 Baritone Sax","69 Oboe","70 English Horn","71 Bassoon","72 Clarinet"],Pipe:["73 Piccolo","74 Flute","75 Recorder","76 Pan Flute","77 Blown Bottle","78 Shakuhachi","79 Whistle","80 Ocarina"],"Synth Lead":["81 Lead 1 (square)","82 Lead 2 (sawtooth)","83 Lead 3 (calliope)","84 Lead 4 (chiff)","85 Lead 5 (charang)","86 Lead 6 (voice)","87 Lead 7 (fifths)","88 Lead 8 (bass + lead)"],"Synth Pad":["89 Pad 1 (new age)","90 Pad 2 (warm)","91 Pad 3 (polysynth)","92 Pad 4 (choir)","93 Pad 5 (bowed)","94 Pad 6 (metallic)","95 Pad 7 (halo)","96 Pad 8 (sweep)"],"Synth Effects":["97 FX 1 (rain)","98 FX 2 (soundtrack)","99 FX 3 (crystal)","100 FX 4 (atmosphere)","101 FX 5 (brightness)","102 FX 6 (goblins)","103 FX 7 (echoes)","104 FX 8 (sci-fi)"],Ethnic:["105 Sitar","106 Banjo","107 Shamisen","108 Koto","109 Kalimba","110 Bagpipe","111 Fiddle","112 Shanai"],Percussive:["113 Tinkle Bell","114 Agogo","115 Steel Drums","116 Woodblock","117 Taiko Drum","118 Melodic Tom","119 Synth Drum"],"Sound effects":["120 Reverse Cymbal","121 Guitar Fret Noise","122 Breath Noise","123 Seashore","124 Bird Tweet","125 Telephone Ring","126 Helicopter","127 Applause","128 Gunshot"]}),e.getInstrument=function(t){var n=e.channels[t];return n&&n.instrument},e.setInstrument=function(t,n,r){var i=e.channels[t];if(r)return setTimeout(function(){i.instrument=n},r);i.instrument=n},e.getMono=function(t){var n=e.channels[t];return n&&n.mono},e.setMono=function(t,n,r){var i=e.channels[t];if(r)return setTimeout(function(){i.mono=n},r);i.mono=n},e.getOmni=function(t){var n=e.channels[t];return n&&n.omni},e.setOmni=function(t,n){var r=e.channels[t];if(delay)return setTimeout(function(){r.omni=n},delay);r.omni=n},e.getSolo=function(t){var n=e.channels[t];return n&&n.solo},e.setSolo=function(t,n){var r=e.channels[t];if(delay)return setTimeout(function(){r.solo=n},delay);r.solo=n},e.channels=function(){for(var e={},t=0;t<16;t++)e[t]={instrument:t,pitchBend:0,mute:!1,mono:!1,omni:!1,solo:!1};return e}(),e.keyToNote={},e.noteToKey={},function(){for(var t=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],n=21;n<=108;n++){var r=t[n%12]+((n-12)/12>>0);e.keyToNote[r]=n,e.noteToKey[n]=r}}()}(MIDI),void 0===MIDI&&(MIDI={}),MIDI.Soundfont=MIDI.Soundfont||{},MIDI.Player=MIDI.Player||{},function(e){"use strict";e.DEBUG=!0,e.USE_XHR=!0,e.soundfontUrl="./soundfont/",e.loadPlugin=function(n){"function"==typeof n&&(n={onsuccess:n}),e.soundfontUrl=n.soundfontUrl||e.soundfontUrl,e.audioDetect(function(r){var i=window.location.hash,a="";if(r[n.api]?a=n.api:r[i.substr(1)]?a=i.substr(1):r.webmidi?a="webmidi":window.AudioContext?a="webaudio":window.Audio&&(a="audiotag"),t[a]){if(n.targetFormat)var o=n.targetFormat;else o=r["audio/ogg"]?"ogg":"mp3";e.__api=a,e.__audioFormat=o,e.supports=r,e.loadResource(n)}})},e.loadResource=function(n){var r=n.instruments||n.instrument||"acoustic_grand_piano";"object"!=typeof r&&(r=r||0===r?[r]:[]);for(var i=0;i<r.length;i++){var a=r[i];a===+a&&e.GM.byId[a]&&(r[i]=e.GM.byId[a].id)}n.format=e.__audioFormat,n.instruments=r,t[e.__api](n)};var t={webmidi:function(t){e.WebMIDI.connect(t)},audiotag:function(e){n(e,"AudioTag")},webaudio:function(e){n(e,"WebAudio")}},n=function(t,n){for(var i=t.format,a=t.instruments,o=t.onprogress,s=t.onerror,u=a.length,l=u,c=function(){--l||(o&&o("load",1),e[n].connect(t))},f=0;f<u;f++){var d=a[f];MIDI.Soundfont[d]?c():r(a[f],i,function(e,t){o&&o("load",t/u+(u-l)/u,d)},function(){c()},s)}},r=function(t,n,r,i,a){var o=e.soundfontUrl+t+"-"+n+".js";e.USE_XHR?e.util.request({url:o,format:"text",onerror:a,onprogress:r,onsuccess:function(e,t){var n=document.createElement("script");n.language="javascript",n.type="text/javascript",n.text=t,document.body.appendChild(n),i()}}):dom.loadScript.add({url:o,verify:'MIDI.Soundfont["'+t+'"]',onerror:a,onsuccess:function(){i()}})};e.setDefaultPlugin=function(t){for(var n in t)e[n]=t[n]}}(MIDI),void 0===MIDI&&(MIDI={}),void 0===MIDI.Player&&(MIDI.Player={}),function(){"use strict";var e=MIDI.Player;e.currentTime=0,e.endTime=0,e.restart=0,e.playing=!1,e.timeWarp=1,e.startDelay=0,e.BPM=120,e.start=e.resume=function(t){e.currentTime<-1&&(e.currentTime=-1),c(e.currentTime,null,t)},e.pause=function(){var t=e.restart;f(),e.restart=t},e.stop=function(){f(),e.restart=0,e.currentTime=0},e.addListener=function(e){o=e},e.removeListener=function(){o=void 0},e.clearAnimation=function(){e.animationFrameId&&cancelAnimationFrame(e.animationFrameId)},e.setAnimation=function(t){var n=0,r=0,i=0;e.clearAnimation();var o=function(){if(e.animationFrameId=requestAnimationFrame(o),0!==e.endTime){e.playing?(n=i===e.currentTime?r-Date.now():0,n=0===e.currentTime?0:e.currentTime-n,i!==e.currentTime&&(r=Date.now(),i=e.currentTime)):n=e.currentTime;var s=e.endTime,u=n/1e3,l=u/60,c=60*l+(u-60*l),f=s/1e3;f-c<-1||t({now:c,end:f,events:a})}};requestAnimationFrame(o)},e.loadMidiFile=function(t,n,r){try{e.replayer=new Replayer(MidiFile(e.currentData),e.timeWarp,null,e.BPM),e.data=e.replayer.getData(),e.endTime=l(),MIDI.loadPlugin({onsuccess:t,onprogress:n,onerror:r})}catch(e){r&&r(e)}},e.loadFile=function(t,n,r,i){if(e.stop(),-1!==t.indexOf("base64,")){var a=window.atob(t.split(",")[1]);e.currentData=a,e.loadMidiFile(n,r,i)}else{var o=new XMLHttpRequest;o.open("GET",t),o.overrideMimeType("text/plain; charset=x-user-defined"),o.onreadystatechange=function(){if(4===this.readyState)if(200===this.status){for(var t=this.responseText||"",a=[],o=t.length,s=String.fromCharCode,u=0;u<o;u++)a[u]=s(255&t.charCodeAt(u));var l=a.join("");e.currentData=l,e.loadMidiFile(n,r,i)}else i&&i("Unable to load MIDI file")},o.send()}},e.getFileInstruments=function(){for(var t={},n={},r=0;r<e.data.length;r++){var i=e.data[r][0].event;if("channel"===i.type){var a=i.channel;switch(i.subtype){case"controller":break;case"programChange":n[a]=i.programNumber;break;case"noteOn":var o=n[a];t[MIDI.GM.byId[isFinite(o)?o:a].id]=!0}}}var s=[];for(var u in t)s.push(u);return s};var t,n,r=[],i=0,a={},o=void 0,s=function(n,i,s,u,l,f,d){return setTimeout(function(){var u={channel:n,note:i,now:s,end:e.endTime,message:l,velocity:f};128===l?delete a[i]:a[i]=u,o&&o(u),e.currentTime=s,r.shift(),r.length<1e3?c(t,!0):e.currentTime===t&&t<e.endTime&&c(t,!0)},s-u)},u=function(){return"webaudio"===MIDI.api?MIDI.WebAudio.getContext():(e.ctx={currentTime:0},e.ctx)},l=function(){for(var t=e.data,n=t.length,r=.5,i=0;i<n;i++)r+=t[i][1];return r},c=function(a,o,c){if(e.replayer){o||(void 0===a&&(a=e.restart),e.playing&&f(),e.playing=!0,e.data=e.replayer.getData(),e.endTime=l());var d,h=0,p=0,v=e.data,m=u(),g=v.length;t=.5;r[0]&&r[0].interval;var y=a-e.currentTime;if("webaudio"!==MIDI.api){var b=window.performance&&window.performance.now?window.performance.now():Date.now();n=n||b,m.currentTime=(b-n)/1e3}i=m.currentTime;for(var w=0;w<g&&p<100;w++){var A=v[w];if((t+=A[1])<=a)h=t;else{a=t-h;var x=A[0].event;if("channel"===x.type){var M=x.channel,k=MIDI.channels[M],_=m.currentTime+(a+y+e.startDelay)/1e3,q=t-h+e.startDelay;switch(x.subtype){case"controller":MIDI.setController(M,x.controllerType,x.value,_);break;case"programChange":MIDI.programChange(M,x.programNumber,_);break;case"pitchBend":MIDI.pitchBend(M,x.value,_);break;case"noteOn":if(k.mute)break;d=x.noteNumber-(e.MIDIOffset||0),r.push({event:x,time:q,source:MIDI.noteOn(M,x.noteNumber,x.velocity,_),interval:s(M,d,t+e.startDelay,h-y,144,x.velocity)}),p++;break;case"noteOff":if(k.mute)break;d=x.noteNumber-(e.MIDIOffset||0),r.push({event:x,time:q,source:MIDI.noteOff(M,x.noteNumber,_),interval:s(M,d,t,h-y,128,0)})}}}}c&&c(r)}},f=function(){var t=u();for(e.playing=!1,e.restart+=1e3*(t.currentTime-i);r.length;){var n=r.pop();window.clearInterval(n.interval),n.source&&("number"==typeof n.source?window.clearTimeout(n.source):n.source.disconnect(0))}for(var s in a){n=a[s];144===a[s].message&&o&&o({channel:n.channel,note:n.note,now:n.now,end:n.end,message:128,velocity:n.velocity})}a={}}}(),function(e){"use strict";window.Audio&&function(){for(var t=e.AudioTag={api:"audiotag"},n={},r=127,i=-1,a=[],o=[],s={},u=0;u<12;u++)a[u]=new Audio;var l=function(t,n){if(e.channels[t]){var u=e.channels[t].instrument,l=e.GM.byId[u].id;if(n=s[n]){var c=l+""+n.id,f=(i+1)%a.length,d=a[f];if(o[f]=c,!e.Soundfont[l])return void(e.DEBUG&&console.log("404",l));d.src=e.Soundfont[l][n.id],d.volume=r/127,d.play(),i=f}}},c=function(t,n){if(e.channels[t]){var r=e.channels[t].instrument,u=e.GM.byId[r].id;if(n=s[n])for(var l=u+""+n.id,c=0,f=a.length;c<f;c++){var d=(c+i+1)%f,h=o[d];if(h&&h==l)return a[d].pause(),void(o[d]=null)}}};t.audioBuffers=a,t.send=function(e,t){},t.setController=function(e,t,n,r){},t.setVolume=function(e,t){r=t},t.programChange=function(t,n){e.channels[t].instrument=n},t.pitchBend=function(e,t,n){},t.noteOn=function(e,t,r,i){var a=n[t];if(s[a])return i?setTimeout(function(){l(e,a)},1e3*i):void l(e,a)},t.noteOff=function(e,t,n){},t.chordOn=function(e,t,r,i){for(var a=0;a<t.length;a++){var o=t[a],u=n[o];if(s[u]){if(i)return setTimeout(function(){l(e,u)},1e3*i);l(e,u)}}},t.chordOff=function(e,t,r){for(var i=0;i<t.length;i++){var a=t[i],o=n[a];if(s[o]){if(r)return setTimeout(function(){c(e,o)},1e3*r);c(e,o)}}},t.stopAllNotes=function(){for(var e=0,t=a.length;e<t;e++)a[e].pause()},t.connect=function(r){e.setDefaultPlugin(t);for(var i in e.keyToNote)n[e.keyToNote[i]]=i,s[i]={id:i};r.onsuccess&&r.onsuccess()}}()}(MIDI),function(e){"use strict";window.AudioContext&&function(){var t,n=!1,r=e.WebAudio={api:"webaudio"},i={},a={},o=127,s={};r.audioBuffers=s,r.send=function(e,t){},r.setController=function(e,t,n,r){},r.setVolume=function(e,t,n){n?setTimeout(function(){o=t},1e3*n):o=t},r.programChange=function(t,n,r){e.channels[t].instrument=n},r.pitchBend=function(t,n,r){e.channels[t].pitchBend=n},r.noteOn=function(r,u,l,c){c=c||0;var f=e.channels[r].instrument,d=s[f+""+u];if(d){if(c<t.currentTime&&(c+=t.currentTime),n)var h=t.createMediaElementSource(d);else{(h=t.createBufferSource()).buffer=d}if(a){var p=h;for(var v in a)p.connect(a[v].input),p=a[v]}var m=l/127*(o/127)*2-1;if(h.connect(t.destination),h.playbackRate.value=1,h.gainNode=t.createGain(),h.gainNode.connect(t.destination),h.gainNode.gain.value=Math.min(1,Math.max(-1,m)),h.connect(h.gainNode),n){if(c)return setTimeout(function(){d.currentTime=0,d.play()},1e3*c);d.currentTime=0,d.play()}else h.start(c||0);return i[r+""+u]=h,h}},r.noteOff=function(r,a,o){o=o||0;var u=e.channels[r].instrument,l=s[u+""+a];if(l){o<t.currentTime&&(o+=t.currentTime);var c=i[r+""+a];if(c){if(c.gainNode){var f=c.gainNode.gain;f.linearRampToValueAtTime(f.value,o),f.linearRampToValueAtTime(-1,o+.3)}return n?o?setTimeout(function(){l.pause()},1e3*o):l.pause():c.noteOff?c.noteOff(o+.5):c.stop(o+.5),delete i[r+""+a],c}}},r.chordOn=function(e,t,n,i){for(var a,o={},s=0,u=t.length;s<u;s++)o[a=t[s]]=r.noteOn(e,a,n,i);return o},r.chordOff=function(e,t,n){for(var i,a={},o=0,s=t.length;o<s;o++)a[i=t[o]]=r.noteOff(e,i,n);return a},r.stopAllNotes=function(){for(var e in i){var n=0;n<t.currentTime&&(n+=t.currentTime);var r=i[e];r.gain.linearRampToValueAtTime(1,n),r.gain.linearRampToValueAtTime(0,n+.3),r.noteOff?r.noteOff(n+.3):r.stop(n+.3),delete i[e]}},r.setEffects=function(e){if(!t.tunajs)return console.log("Effects module not installed.");for(var n=0;n<e.length;n++){var r=e[n],i=new t.tunajs[r.type](r);i.connect(t.destination),a[r.type]=i}},r.connect=function(n){e.setDefaultPlugin(r),r.setContext(t||new(window.AudioContext||window.webkitAudioContext),n.onsuccess)},r.getContext=function(){return t},r.setContext=function(r,i,a,o){t=r,"undefined"==typeof Tuna||t.tunajs||(t.tunajs=new Tuna(t));var u=[],l=e.keyToNote;for(var c in l)u.push(c);var f=function(e){for(var t in h)if(h[t])return;i&&(i(),i=null)},d=function(r,i,a,o){var u=r[o];u&&(h[i]++,function(e,r,i){if(n){var a=new Audio;a.src=e,a.controls=!1,a.autoplay=!1,a.preload=!1,a.addEventListener("canplay",function(){r&&r(a)}),a.addEventListener("error",function(e){i&&i(e)}),document.body.appendChild(a)}else if(0===e.indexOf("data:audio")){var o=e.split(",")[1],s=Base64Binary.decodeArrayBuffer(o);t.decodeAudioData(s,r,i)}else{var u=new XMLHttpRequest;u.open("GET",e,!0),u.responseType="arraybuffer",u.onload=function(){t.decodeAudioData(u.response,r,i)},u.send()}}(u,function(t){t.id=o;var n=e.keyToNote[o];if(s[i+""+n]=t,0==--h[i]){r.isLoaded=!0,f()}},function(e){}))},h={};for(var p in e.Soundfont){var v=e.Soundfont[p];if(!v.isLoaded){var m=e.GM.byName[p].number;h[m]=0;for(var g=0;g<u.length;g++){d(v,m,0,c=u[g])}}}setTimeout(f,1)}}()}(MIDI),function(e){"use strict";var t=null,n=e.WebMIDI={api:"webmidi"};n.send=function(e,n){t.send(e,1e3*n)},n.setController=function(e,n,r,i){t.send([e,n,r],1e3*i)},n.setVolume=function(e,n,r){t.send([176+e,7,n],1e3*r)},n.programChange=function(e,n,r){t.send([192+e,n],1e3*r)},n.pitchBend=function(e,n,r){t.send([224+e,n],1e3*r)},n.noteOn=function(e,n,r,i){t.send([144+e,n,r],1e3*i)},n.noteOff=function(e,n,r){t.send([128+e,n,0],1e3*r)},n.chordOn=function(e,n,r,i){for(var a=0;a<n.length;a++){var o=n[a];t.send([144+e,o,r],1e3*i)}},n.chordOff=function(e,n,r){for(var i=0;i<n.length;i++){var a=n[i];t.send([128+e,a,0],1e3*r)}},n.stopAllNotes=function(){t.cancel();for(var e=0;e<16;e++)t.send([176+e,123,0])},n.connect=function(r){e.setDefaultPlugin(n);var i=function(t){if(window.AudioContext)r.api="webaudio";else{if(!window.Audio)return;r.api="audiotag"}e.loadPlugin(r)};navigator.requestMIDIAccess().then(function(e){var n=e.outputs;void 0===(t="function"==typeof n?n()[0]:n[0])?i():r.onsuccess&&r.onsuccess()},i)}}(MIDI),void 0===MIDI)var MIDI={};if(MIDI.Synesthesia=MIDI.Synesthesia||{},function(e){e.data={"Isaac Newton (1704)":{format:"HSL",ref:"Gerstner, p.167",english:["red",null,"orange",null,"yellow","green",null,"blue",null,"indigo",null,"violet"],0:[0,96,51],1:[0,0,0],2:[29,94,52],3:[0,0,0],4:[60,90,60],5:[135,76,32],6:[0,0,0],7:[248,82,28],8:[0,0,0],9:[302,88,26],10:[0,0,0],11:[325,84,46]},"Louis Bertrand Castel (1734)":{format:"HSL",ref:"Peacock, p.400",english:["blue","blue-green","green","olive green","yellow","yellow-orange","orange","red","crimson","violet","agate","indigo"],0:[248,82,28],1:[172,68,34],2:[135,76,32],3:[79,59,36],4:[60,90,60],5:[49,90,60],6:[29,94,52],7:[360,96,51],8:[1,89,33],9:[325,84,46],10:[273,80,27],11:[302,88,26]},"George Field (1816)":{format:"HSL",ref:"Klein, p.69",english:["blue",null,"purple",null,"red","orange",null,"yellow",null,"yellow green",null,"green"],0:[248,82,28],1:[0,0,0],2:[302,88,26],3:[0,0,0],4:[360,96,51],5:[29,94,52],6:[0,0,0],7:[60,90,60],8:[0,0,0],9:[79,59,36],10:[0,0,0],11:[135,76,32]},"D. D. Jameson (1844)":{format:"HSL",ref:"Jameson, p.12",english:["red","red-orange","orange","orange-yellow","yellow","green","green-blue","blue","blue-purple","purple","purple-violet","violet"],0:[360,96,51],1:[14,91,51],2:[29,94,52],3:[49,90,60],4:[60,90,60],5:[135,76,32],6:[172,68,34],7:[248,82,28],8:[273,80,27],9:[302,88,26],10:[313,78,37],11:[325,84,46]},"Theodor Seemann (1881)":{format:"HSL",ref:"Klein, p.86",english:["carmine","scarlet","orange","yellow-orange","yellow","green","green blue","blue","indigo","violet","brown","black"],0:[0,58,26],1:[360,96,51],2:[29,94,52],3:[49,90,60],4:[60,90,60],5:[135,76,32],6:[172,68,34],7:[248,82,28],8:[302,88,26],9:[325,84,46],10:[0,58,26],11:[0,0,3]},"A. Wallace Rimington (1893)":{format:"HSL",ref:"Peacock, p.402",english:["deep red","crimson","orange-crimson","orange","yellow","yellow-green","green","blueish green","blue-green","indigo","deep blue","violet"],0:[360,96,51],1:[1,89,33],2:[14,91,51],3:[29,94,52],4:[60,90,60],5:[79,59,36],6:[135,76,32],7:[163,62,40],8:[172,68,34],9:[302,88,26],10:[248,82,28],11:[325,84,46]},"Bainbridge Bishop (1893)":{format:"HSL",ref:"Bishop, p.11",english:["red","orange-red or scarlet","orange","gold or yellow-orange","yellow or green-gold","yellow-green","green","greenish-blue or aquamarine","blue","indigo or violet-blue","violet","violet-red","red"],0:[360,96,51],1:[1,89,33],2:[29,94,52],3:[50,93,52],4:[60,90,60],5:[73,73,55],6:[135,76,32],7:[163,62,40],8:[302,88,26],9:[325,84,46],10:[343,79,47],11:[360,96,51]},"H. von Helmholtz (1910)":{format:"HSL",ref:"Helmholtz, p.22",english:["yellow","green","greenish blue","cayan-blue","indigo blue","violet","end of red","red","red","red","red orange","orange"],0:[60,90,60],1:[135,76,32],2:[172,68,34],3:[211,70,37],4:[302,88,26],5:[325,84,46],6:[330,84,34],7:[360,96,51],8:[10,91,43],9:[10,91,43],10:[8,93,51],11:[28,89,50]},"Alexander Scriabin (1911)":{format:"HSL",ref:"Jones, p.104",english:["red","violet","yellow","steely with the glint of metal","pearly blue the shimmer of moonshine","dark red","bright blue","rosy orange","purple","green","steely with a glint of metal","pearly blue the shimmer of moonshine"],0:[360,96,51],1:[325,84,46],2:[60,90,60],3:[245,21,43],4:[211,70,37],5:[1,89,33],6:[248,82,28],7:[29,94,52],8:[302,88,26],9:[135,76,32],10:[245,21,43],11:[211,70,37]},"Adrian Bernard Klein (1930)":{format:"HSL",ref:"Klein, p.209",english:["dark red","red","red orange","orange","yellow","yellow green","green","blue-green","blue","blue violet","violet","dark violet"],0:[0,91,40],1:[360,96,51],2:[14,91,51],3:[29,94,52],4:[60,90,60],5:[73,73,55],6:[135,76,32],7:[172,68,34],8:[248,82,28],9:[292,70,31],10:[325,84,46],11:[330,84,34]},"August Aeppli (1940)":{format:"HSL",ref:"Gerstner, p.169",english:["red",null,"orange",null,"yellow",null,"green","blue-green",null,"ultramarine blue","violet","purple"],0:[0,96,51],1:[0,0,0],2:[29,94,52],3:[0,0,0],4:[60,90,60],5:[0,0,0],6:[135,76,32],7:[172,68,34],8:[0,0,0],9:[211,70,37],10:[273,80,27],11:[302,88,26]},"I. J. Belmont (1944)":{ref:"Belmont, p.226",english:["red","red-orange","orange","yellow-orange","yellow","yellow-green","green","blue-green","blue","blue-violet","violet","red-violet"],0:[360,96,51],1:[14,91,51],2:[29,94,52],3:[50,93,52],4:[60,90,60],5:[73,73,55],6:[135,76,32],7:[172,68,34],8:[248,82,28],9:[313,78,37],10:[325,84,46],11:[338,85,37]},"Steve Zieverink (2004)":{format:"HSL",ref:"Cincinnati Contemporary Art Center",english:["yellow-green","green","blue-green","blue","indigo","violet","ultra violet","infra red","red","orange","yellow-white","yellow"],0:[73,73,55],1:[135,76,32],2:[172,68,34],3:[248,82,28],4:[302,88,26],5:[325,84,46],6:[326,79,24],7:[1,89,33],8:[360,96,51],9:[29,94,52],10:[62,78,74],11:[60,90,60]},"Circle of Fifths (Johnston 2003)":{format:"RGB",ref:"Joseph Johnston",english:["yellow","blue","orange","teal","red","green","purple","light orange","light blue","dark orange","dark green","violet"],0:[255,255,0],1:[50,0,255],2:[255,150,0],3:[0,210,180],4:[255,0,0],5:[130,255,0],6:[150,0,200],7:[255,195,0],8:[30,130,255],9:[255,100,0],10:[0,200,0],11:[225,0,225]},"Circle of Fifths (Wheatman 2002)":{format:"HEX",ref:"Stuart Wheatman",english:[],data:["#122400","#2E002E","#002914","#470000","#002142","#2E2E00","#290052","#003D00","#520029","#003D3D","#522900","#000080","#244700","#570057","#004D26","#7A0000","#003B75","#4C4D00","#47008F","#006100","#850042","#005C5C","#804000","#0000C7","#366B00","#80007F","#00753B","#B80000","#0057AD","#6B6B00","#6600CC","#008A00","#B8005C","#007F80","#B35900","#2424FF","#478F00","#AD00AD","#00994D","#F00000","#0073E6","#8F8F00","#8A14FF","#00AD00","#EB0075","#00A3A3","#E07000","#6B6BFF","#5CB800","#DB00DB","#00C261","#FF5757","#3399FF","#ADAD00","#B56BFF","#00D600","#FF57AB","#00C7C7","#FF9124","#9999FF","#6EDB00","#FF29FF","#00E070","#FF9999","#7ABDFF","#D1D100","#D1A3FF","#00FA00","#FFA3D1","#00E5E6","#FFC285","#C2C2FF","#80FF00","#FFA8FF","#00E070","#FFCCCC","#C2E0FF","#F0F000","#EBD6FF","#ADFFAD","#FFD6EB","#8AFFFF","#FFEBD6","#EBEBFF","#E0FFC2","#FFEBFF","#E5FFF2","#FFF5F5"]}},e.map=function(t){for(var n,r,i,a,o={},s=e.data,u=s[t]||s["D. D. Jameson (1844)"],l=0;l<=88;l++)if(u.data)o[l]={hsl:u.data[l],hex:u.data[l]};else{var c=u[(l+9)%12];switch(u.format){case"RGB":r=(c=Color.Space(c,"RGB>HSL")).H>>0,i=c.S>>0,a=c.L>>0;break;case"HSL":r=c[0],i=c[1],a=c[2]}r===i&&i===a&&(f=n,d=u[(l+10)%12],c=[.5*f[0]+.5*d[0]+.5>>0,.5*f[1]+.5*d[1]+.5>>0,.5*f[2]+.5*d[2]+.5>>0]),o[l]={hsl:"hsla("+r+","+i+"%,"+a+"%, 1)",hex:Color.Space({H:r,S:i,L:a},"HSL>RGB>HEX>W3")},n=c}var f,d;return o}}(MIDI.Synesthesia),void 0===dom)var dom={};!function(){"use strict";dom.loadScript=function(){return this.loaded={},this.loading={},this},dom.loadScript.prototype.add=function(t){var n=this;"string"==typeof t&&(t={url:t});var r=t.urls;void 0===r&&(r=[{url:t.url,verify:t.verify}]);var i=document.getElementsByTagName("head")[0],a=function(t,r){n.loaded[t.url]||r&&!1===e(r)||(n.loaded[t.url]=!0,n.loading[t.url]&&n.loading[t.url](),delete n.loading[t.url],t.onsuccess&&t.onsuccess(),void 0!==d&&d())},o=!1,s=[],u=function(e){if("string"==typeof e&&(e={url:e,verify:t.verify}),/([\w\d.\[\]\'\"])$/.test(e.verify)){var r=e.test=e.verify;if("object"==typeof r)for(var u=0;u<r.length;u++)s.push(r[u]);else s.push(r)}if(!n.loaded[e.url]){var c=document.createElement("script");c.onreadystatechange=function(){"loaded"!==this.readyState&&"complete"!==this.readyState||a(e)},c.onload=function(){a(e)},c.onerror=function(){if(o=!0,delete n.loading[e.url],"object"==typeof e.test)for(var t in e.test)l(e.test[t]);else l(e.test)},c.setAttribute("type","text/javascript"),c.setAttribute("src",e.url),i.appendChild(c),n.loading[e.url]=function(){}}},l=function(e){for(var t=[],n=0;n<s.length;n++)s[n]!==e&&t.push(s[n]);s=t},c=function(n){if(n)a(n,n.test);else for(var i=0;i<r.length;i++)a(r[i],r[i].test);var u=!0;for(i=0;i<s.length;i++)!1===e(s[i])&&(u=!1);!t.strictOrder&&u?o?t.error&&t.error():t.onsuccess&&t.onsuccess():setTimeout(function(){c(n)},10)};if(t.strictOrder){var f=-1,d=function(){if(r[++f]){var e=r[f],i=e.url;n.loading[i]?n.loading[i]=function(){e.onsuccess&&e.onsuccess(),d()}:n.loaded[i]?d():(u(e),c(e))}else o?t.error&&t.error():t.onsuccess&&t.onsuccess()};d()}else for(f=0;f<r.length;f++)u(r[f]),c(r[f])},dom.loadScript=new dom.loadScript;var e=function(e,t){try{for(var n=(e=e.split('"').join("").split("'").join("").split("]").join("").split("[").join(".")).split("."),r=n.length,i=t||window,a=0;a<r;a++){var o=n[a];if(null==i[o])return!1;i=i[o]}return!0}catch(e){return!1}}}(),"undefined"!=typeof module&&module.exports&&(module.exports=dom.loadScript),void 0===MIDI&&(MIDI={}),function(e){if((e.util||(e.util={})).request=function(n,r,i,a){"use strict";"string"==typeof n&&(n={url:n});var o=n.data,s=n.url,u=n.method||(n.data?"POST":"GET"),l=n.format,c=n.headers,f=n.responseType,d=n.withCredentials||!1;r=r||n.onsuccess,i=i||n.onerror,a=a||n.onprogress;if(void 0===t||!e.loc.isLocalUrl(s)){var h=new XMLHttpRequest;if(h.open(u,s,!0),c)for(var p in c)h.setRequestHeader(p,c[p]);else o&&h.setRequestHeader("Content-type","application/x-www-form-urlencoded");return"binary"===l&&h.overrideMimeType&&h.overrideMimeType("text/plain; charset=x-user-defined"),f&&(h.responseType=f),d&&(h.withCredentials="true"),i&&"onerror"in h&&(h.onerror=i),a&&h.upload&&"onprogress"in h.upload&&(o?h.upload.onprogress=function(e){a.call(h,e,event.loaded/event.total)}:h.addEventListener("progress",function(e){var t=0;if(e.lengthComputable)t=e.total;else if(h.totalBytes)t=h.totalBytes;else{var n=parseInt(h.getResponseHeader("Content-Length-Raw"));if(!isFinite(n))return;h.totalBytes=t=n}a.call(h,e,e.loaded/t)})),h.onreadystatechange=function(t){if(4===h.readyState)if(200===h.status||304===h.status||308===h.status||0===h.status&&e.client.cordova){if(r){var n;if("xml"===l)n=t.target.responseXML;else if("text"===l)n=t.target.responseText;else if("json"===l)try{n=JSON.parse(t.target.response)}catch(e){i&&i.call(h,t)}r.call(h,t,n)}}else i&&i.call(h,t)},h.send(o),h}t.readFile(s,"utf8",function(e,t){e?i&&i(e):r&&r({responseText:t})})},"undefined"!=typeof module&&module.exports){var t=require("fs");XMLHttpRequest=require("xmlhttprequest").XMLHttpRequest,module.exports=e.util.request}}(MIDI);
